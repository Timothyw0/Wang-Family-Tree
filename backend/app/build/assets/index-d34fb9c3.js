import{r as E,u as Li,j as A,L as Bi,_ as Vo}from"./index-5d09a97b.js";import{u as Oi,a as Vi}from"./useLanguageSelector-34e5d545.js";import{c as Fi}from"./chunk-QODHG6BI-5c01519f.js";function ct(t){if(typeof t=="string"||typeof t=="number")return""+t;let e="";if(Array.isArray(t))for(let n=0,o;n<t.length;n++)(o=ct(t[n]))!==""&&(e+=(e&&" ")+o);else for(let n in t)t[n]&&(e+=(e&&" ")+n);return e}const Qn=t=>{let e;const n=new Set,o=(c,u)=>{const l=typeof c=="function"?c(e):c;if(!Object.is(l,e)){const f=e;e=u??typeof l!="object"?l:Object.assign({},e,l),n.forEach(d=>d(e,f))}},r=()=>e,a={setState:o,getState:r,subscribe:c=>(n.add(c),()=>n.delete(c)),destroy:()=>{({BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&"production")!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}};return e=t(o,r,a),a},Xi=t=>t?Qn(t):Qn,{useSyncExternalStoreWithSelector:Yi}=Li;function ji(t,e=t.getState,n){const o=Yi(t.subscribe,t.getState,t.getServerState||t.getState,e,n);return E.useDebugValue(o),o}function ot(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(const[o,r]of t)if(!Object.is(r,e.get(o)))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(const o of t)if(!e.has(o))return!1;return!0}const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!1;for(let o=0;o<n.length;o++)if(!Object.prototype.hasOwnProperty.call(e,n[o])||!Object.is(t[n[o]],e[n[o]]))return!1;return!0}var Zi={value:()=>{}};function Qe(){for(var t=0,e=arguments.length,n={},o;t<e;++t){if(!(o=arguments[t]+"")||o in n||/[\s.]/.test(o))throw new Error("illegal type: "+o);n[o]=[]}return new Oe(n)}function Oe(t){this._=t}function Wi(t,e){return t.trim().split(/^|\s+/).map(function(n){var o="",r=n.indexOf(".");if(r>=0&&(o=n.slice(r+1),n=n.slice(0,r)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:o}})}Oe.prototype=Qe.prototype={constructor:Oe,on:function(t,e){var n=this._,o=Wi(t+"",n),r,s=-1,i=o.length;if(arguments.length<2){for(;++s<i;)if((r=(t=o[s]).type)&&(r=Ki(n[r],t.name)))return r;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<i;)if(r=(t=o[s]).type)n[r]=Jn(n[r],t.name,e);else if(e==null)for(r in n)n[r]=Jn(n[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Oe(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var n=new Array(r),o=0,r,s;o<r;++o)n[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],o=0,r=s.length;o<r;++o)s[o].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var o=this._[t],r=0,s=o.length;r<s;++r)o[r].value.apply(e,n)}};function Ki(t,e){for(var n=0,o=t.length,r;n<o;++n)if((r=t[n]).name===e)return r.value}function Jn(t,e,n){for(var o=0,r=t.length;o<r;++o)if(t[o].name===e){t[o]=Zi,t=t.slice(0,o).concat(t.slice(o+1));break}return n!=null&&t.push({name:e,value:n}),t}var wn="http://www.w3.org/1999/xhtml";const to={svg:"http://www.w3.org/2000/svg",xhtml:wn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Je(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),to.hasOwnProperty(e)?{space:to[e],local:t}:t}function Ui(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===wn&&e.documentElement.namespaceURI===wn?e.createElement(t):e.createElementNS(n,t)}}function Gi(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Fo(t){var e=Je(t);return(e.local?Gi:Ui)(e)}function qi(){}function Dn(t){return t==null?qi:function(){return this.querySelector(t)}}function Qi(t){typeof t!="function"&&(t=Dn(t));for(var e=this._groups,n=e.length,o=new Array(n),r=0;r<n;++r)for(var s=e[r],i=s.length,a=o[r]=new Array(i),c,u,l=0;l<i;++l)(c=s[l])&&(u=t.call(c,c.__data__,l,s))&&("__data__"in c&&(u.__data__=c.__data__),a[l]=u);return new at(o,this._parents)}function Ji(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function ts(){return[]}function Xo(t){return t==null?ts:function(){return this.querySelectorAll(t)}}function es(t){return function(){return Ji(t.apply(this,arguments))}}function ns(t){typeof t=="function"?t=es(t):t=Xo(t);for(var e=this._groups,n=e.length,o=[],r=[],s=0;s<n;++s)for(var i=e[s],a=i.length,c,u=0;u<a;++u)(c=i[u])&&(o.push(t.call(c,c.__data__,u,i)),r.push(c));return new at(o,r)}function Yo(t){return function(){return this.matches(t)}}function jo(t){return function(e){return e.matches(t)}}var os=Array.prototype.find;function rs(t){return function(){return os.call(this.children,t)}}function is(){return this.firstElementChild}function ss(t){return this.select(t==null?is:rs(typeof t=="function"?t:jo(t)))}var as=Array.prototype.filter;function cs(){return Array.from(this.children)}function ls(t){return function(){return as.call(this.children,t)}}function us(t){return this.selectAll(t==null?cs:ls(typeof t=="function"?t:jo(t)))}function fs(t){typeof t!="function"&&(t=Yo(t));for(var e=this._groups,n=e.length,o=new Array(n),r=0;r<n;++r)for(var s=e[r],i=s.length,a=o[r]=[],c,u=0;u<i;++u)(c=s[u])&&t.call(c,c.__data__,u,s)&&a.push(c);return new at(o,this._parents)}function Zo(t){return new Array(t.length)}function ds(){return new at(this._enter||this._groups.map(Zo),this._parents)}function Ye(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Ye.prototype={constructor:Ye,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function hs(t){return function(){return t}}function gs(t,e,n,o,r,s){for(var i=0,a,c=e.length,u=s.length;i<u;++i)(a=e[i])?(a.__data__=s[i],o[i]=a):n[i]=new Ye(t,s[i]);for(;i<c;++i)(a=e[i])&&(r[i]=a)}function ps(t,e,n,o,r,s,i){var a,c,u=new Map,l=e.length,f=s.length,d=new Array(l),h;for(a=0;a<l;++a)(c=e[a])&&(d[a]=h=i.call(c,c.__data__,a,e)+"",u.has(h)?r[a]=c:u.set(h,c));for(a=0;a<f;++a)h=i.call(t,s[a],a,s)+"",(c=u.get(h))?(o[a]=c,c.__data__=s[a],u.delete(h)):n[a]=new Ye(t,s[a]);for(a=0;a<l;++a)(c=e[a])&&u.get(d[a])===c&&(r[a]=c)}function ys(t){return t.__data__}function ms(t,e){if(!arguments.length)return Array.from(this,ys);var n=e?ps:gs,o=this._parents,r=this._groups;typeof t!="function"&&(t=hs(t));for(var s=r.length,i=new Array(s),a=new Array(s),c=new Array(s),u=0;u<s;++u){var l=o[u],f=r[u],d=f.length,h=xs(t.call(l,l&&l.__data__,u,o)),v=h.length,x=a[u]=new Array(v),b=i[u]=new Array(v),p=c[u]=new Array(d);n(l,f,x,b,p,h,e);for(var S=0,$=0,m,M;S<v;++S)if(m=x[S]){for(S>=$&&($=S+1);!(M=b[$])&&++$<v;);m._next=M||null}}return i=new at(i,o),i._enter=a,i._exit=c,i}function xs(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function ws(){return new at(this._exit||this._groups.map(Zo),this._parents)}function bs(t,e,n){var o=this.enter(),r=this,s=this.exit();return typeof t=="function"?(o=t(o),o&&(o=o.selection())):o=o.append(t+""),e!=null&&(r=e(r),r&&(r=r.selection())),n==null?s.remove():n(s),o&&r?o.merge(r).order():r}function vs(t){for(var e=t.selection?t.selection():t,n=this._groups,o=e._groups,r=n.length,s=o.length,i=Math.min(r,s),a=new Array(r),c=0;c<i;++c)for(var u=n[c],l=o[c],f=u.length,d=a[c]=new Array(f),h,v=0;v<f;++v)(h=u[v]||l[v])&&(d[v]=h);for(;c<r;++c)a[c]=n[c];return new at(a,this._parents)}function _s(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var o=t[e],r=o.length-1,s=o[r],i;--r>=0;)(i=o[r])&&(s&&i.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(i,s),s=i);return this}function Ss(t){t||(t=Es);function e(f,d){return f&&d?t(f.__data__,d.__data__):!f-!d}for(var n=this._groups,o=n.length,r=new Array(o),s=0;s<o;++s){for(var i=n[s],a=i.length,c=r[s]=new Array(a),u,l=0;l<a;++l)(u=i[l])&&(c[l]=u);c.sort(e)}return new at(r,this._parents).order()}function Es(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Ns(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Ms(){return Array.from(this)}function Cs(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var o=t[e],r=0,s=o.length;r<s;++r){var i=o[r];if(i)return i}return null}function As(){let t=0;for(const e of this)++t;return t}function $s(){return!this.node()}function ks(t){for(var e=this._groups,n=0,o=e.length;n<o;++n)for(var r=e[n],s=0,i=r.length,a;s<i;++s)(a=r[s])&&t.call(a,a.__data__,s,r);return this}function Ts(t){return function(){this.removeAttribute(t)}}function Ps(t){return function(){this.removeAttributeNS(t.space,t.local)}}function zs(t,e){return function(){this.setAttribute(t,e)}}function Ds(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Rs(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Is(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Hs(t,e){var n=Je(t);if(arguments.length<2){var o=this.node();return n.local?o.getAttributeNS(n.space,n.local):o.getAttribute(n)}return this.each((e==null?n.local?Ps:Ts:typeof e=="function"?n.local?Is:Rs:n.local?Ds:zs)(n,e))}function Wo(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Ls(t){return function(){this.style.removeProperty(t)}}function Bs(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Os(t,e,n){return function(){var o=e.apply(this,arguments);o==null?this.style.removeProperty(t):this.style.setProperty(t,o,n)}}function Vs(t,e,n){return arguments.length>1?this.each((e==null?Ls:typeof e=="function"?Os:Bs)(t,e,n??"")):se(this.node(),t)}function se(t,e){return t.style.getPropertyValue(e)||Wo(t).getComputedStyle(t,null).getPropertyValue(e)}function Fs(t){return function(){delete this[t]}}function Xs(t,e){return function(){this[t]=e}}function Ys(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function js(t,e){return arguments.length>1?this.each((e==null?Fs:typeof e=="function"?Ys:Xs)(t,e)):this.node()[t]}function Ko(t){return t.trim().split(/^|\s+/)}function Rn(t){return t.classList||new Uo(t)}function Uo(t){this._node=t,this._names=Ko(t.getAttribute("class")||"")}Uo.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Go(t,e){for(var n=Rn(t),o=-1,r=e.length;++o<r;)n.add(e[o])}function qo(t,e){for(var n=Rn(t),o=-1,r=e.length;++o<r;)n.remove(e[o])}function Zs(t){return function(){Go(this,t)}}function Ws(t){return function(){qo(this,t)}}function Ks(t,e){return function(){(e.apply(this,arguments)?Go:qo)(this,t)}}function Us(t,e){var n=Ko(t+"");if(arguments.length<2){for(var o=Rn(this.node()),r=-1,s=n.length;++r<s;)if(!o.contains(n[r]))return!1;return!0}return this.each((typeof e=="function"?Ks:e?Zs:Ws)(n,e))}function Gs(){this.textContent=""}function qs(t){return function(){this.textContent=t}}function Qs(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Js(t){return arguments.length?this.each(t==null?Gs:(typeof t=="function"?Qs:qs)(t)):this.node().textContent}function ta(){this.innerHTML=""}function ea(t){return function(){this.innerHTML=t}}function na(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function oa(t){return arguments.length?this.each(t==null?ta:(typeof t=="function"?na:ea)(t)):this.node().innerHTML}function ra(){this.nextSibling&&this.parentNode.appendChild(this)}function ia(){return this.each(ra)}function sa(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function aa(){return this.each(sa)}function ca(t){var e=typeof t=="function"?t:Fo(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function la(){return null}function ua(t,e){var n=typeof t=="function"?t:Fo(t),o=e==null?la:typeof e=="function"?e:Dn(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),o.apply(this,arguments)||null)})}function fa(){var t=this.parentNode;t&&t.removeChild(this)}function da(){return this.each(fa)}function ha(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ga(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function pa(t){return this.select(t?ga:ha)}function ya(t){return arguments.length?this.property("__data__",t):this.node().__data__}function ma(t){return function(e){t.call(this,e,this.__data__)}}function xa(t){return t.trim().split(/^|\s+/).map(function(e){var n="",o=e.indexOf(".");return o>=0&&(n=e.slice(o+1),e=e.slice(0,o)),{type:e,name:n}})}function wa(t){return function(){var e=this.__on;if(e){for(var n=0,o=-1,r=e.length,s;n<r;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++o]=s;++o?e.length=o:delete this.__on}}}function ba(t,e,n){return function(){var o=this.__on,r,s=ma(e);if(o){for(var i=0,a=o.length;i<a;++i)if((r=o[i]).type===t.type&&r.name===t.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=s,r.options=n),r.value=e;return}}this.addEventListener(t.type,s,n),r={type:t.type,name:t.name,value:e,listener:s,options:n},o?o.push(r):this.__on=[r]}}function va(t,e,n){var o=xa(t+""),r,s=o.length,i;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,u=a.length,l;c<u;++c)for(r=0,l=a[c];r<s;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value}return}for(a=e?ba:wa,r=0;r<s;++r)this.each(a(o[r],e,n));return this}function Qo(t,e,n){var o=Wo(t),r=o.CustomEvent;typeof r=="function"?r=new r(e,n):(r=o.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function _a(t,e){return function(){return Qo(this,t,e)}}function Sa(t,e){return function(){return Qo(this,t,e.apply(this,arguments))}}function Ea(t,e){return this.each((typeof e=="function"?Sa:_a)(t,e))}function*Na(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var o=t[e],r=0,s=o.length,i;r<s;++r)(i=o[r])&&(yield i)}var Jo=[null];function at(t,e){this._groups=t,this._parents=e}function Ae(){return new at([[document.documentElement]],Jo)}function Ma(){return this}at.prototype=Ae.prototype={constructor:at,select:Qi,selectAll:ns,selectChild:ss,selectChildren:us,filter:fs,data:ms,enter:ds,exit:ws,join:bs,merge:vs,selection:Ma,order:_s,sort:Ss,call:Ns,nodes:Ms,node:Cs,size:As,empty:$s,each:ks,attr:Hs,style:Vs,property:js,classed:Us,text:Js,html:oa,raise:ia,lower:aa,append:ca,insert:ua,remove:da,clone:pa,datum:ya,on:va,dispatch:Ea,[Symbol.iterator]:Na};function ht(t){return typeof t=="string"?new at([[document.querySelector(t)]],[document.documentElement]):new at([[t]],Jo)}function Ca(t){let e;for(;e=t.sourceEvent;)t=e;return t}function xt(t,e){if(t=Ca(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=t.clientX,o.y=t.clientY,o=o.matrixTransform(e.getScreenCTM().inverse()),[o.x,o.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}const Aa={passive:!1},ve={capture:!0,passive:!1};function ln(t){t.stopImmediatePropagation()}function ee(t){t.preventDefault(),t.stopImmediatePropagation()}function tr(t){var e=t.document.documentElement,n=ht(t).on("dragstart.drag",ee,ve);"onselectstart"in e?n.on("selectstart.drag",ee,ve):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function er(t,e){var n=t.document.documentElement,o=ht(t).on("dragstart.drag",null);e&&(o.on("click.drag",ee,ve),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Pe=t=>()=>t;function bn(t,{sourceEvent:e,subject:n,target:o,identifier:r,active:s,x:i,y:a,dx:c,dy:u,dispatch:l}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:l}})}bn.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function $a(t){return!t.ctrlKey&&!t.button}function ka(){return this.parentNode}function Ta(t,e){return e??{x:t.x,y:t.y}}function Pa(){return navigator.maxTouchPoints||"ontouchstart"in this}function za(){var t=$a,e=ka,n=Ta,o=Pa,r={},s=Qe("start","drag","end"),i=0,a,c,u,l,f=0;function d(m){m.on("mousedown.drag",h).filter(o).on("touchstart.drag",b).on("touchmove.drag",p,Aa).on("touchend.drag touchcancel.drag",S).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(m,M){if(!(l||!t.call(this,m,M))){var C=$(this,e.call(this,m,M),m,M,"mouse");C&&(ht(m.view).on("mousemove.drag",v,ve).on("mouseup.drag",x,ve),tr(m.view),ln(m),u=!1,a=m.clientX,c=m.clientY,C("start",m))}}function v(m){if(ee(m),!u){var M=m.clientX-a,C=m.clientY-c;u=M*M+C*C>f}r.mouse("drag",m)}function x(m){ht(m.view).on("mousemove.drag mouseup.drag",null),er(m.view,u),ee(m),r.mouse("end",m)}function b(m,M){if(t.call(this,m,M)){var C=m.changedTouches,P=e.call(this,m,M),D=C.length,I,B;for(I=0;I<D;++I)(B=$(this,P,m,M,C[I].identifier,C[I]))&&(ln(m),B("start",m,C[I]))}}function p(m){var M=m.changedTouches,C=M.length,P,D;for(P=0;P<C;++P)(D=r[M[P].identifier])&&(ee(m),D("drag",m,M[P]))}function S(m){var M=m.changedTouches,C=M.length,P,D;for(l&&clearTimeout(l),l=setTimeout(function(){l=null},500),P=0;P<C;++P)(D=r[M[P].identifier])&&(ln(m),D("end",m,M[P]))}function $(m,M,C,P,D,I){var B=s.copy(),R=xt(I||C,M),H,k,g;if((g=n.call(m,new bn("beforestart",{sourceEvent:C,target:d,identifier:D,active:i,x:R[0],y:R[1],dx:0,dy:0,dispatch:B}),P))!=null)return H=g.x-R[0]||0,k=g.y-R[1]||0,function N(w,y,_){var T=R,z;switch(w){case"start":r[D]=N,z=i++;break;case"end":delete r[D],--i;case"drag":R=xt(_||y,M),z=i;break}B.call(w,m,new bn(w,{sourceEvent:y,subject:g,target:d,identifier:D,active:z,x:R[0]+H,y:R[1]+k,dx:R[0]-T[0],dy:R[1]-T[1],dispatch:B}),P)}}return d.filter=function(m){return arguments.length?(t=typeof m=="function"?m:Pe(!!m),d):t},d.container=function(m){return arguments.length?(e=typeof m=="function"?m:Pe(m),d):e},d.subject=function(m){return arguments.length?(n=typeof m=="function"?m:Pe(m),d):n},d.touchable=function(m){return arguments.length?(o=typeof m=="function"?m:Pe(!!m),d):o},d.on=function(){var m=s.on.apply(s,arguments);return m===s?d:m},d.clickDistance=function(m){return arguments.length?(f=(m=+m)*m,d):Math.sqrt(f)},d}function In(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function nr(t,e){var n=Object.create(t.prototype);for(var o in e)n[o]=e[o];return n}function $e(){}var _e=.7,je=1/_e,ne="\\s*([+-]?\\d+)\\s*",Se="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",wt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Da=/^#([0-9a-f]{3,8})$/,Ra=new RegExp(`^rgb\\(${ne},${ne},${ne}\\)$`),Ia=new RegExp(`^rgb\\(${wt},${wt},${wt}\\)$`),Ha=new RegExp(`^rgba\\(${ne},${ne},${ne},${Se}\\)$`),La=new RegExp(`^rgba\\(${wt},${wt},${wt},${Se}\\)$`),Ba=new RegExp(`^hsl\\(${Se},${wt},${wt}\\)$`),Oa=new RegExp(`^hsla\\(${Se},${wt},${wt},${Se}\\)$`),eo={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};In($e,Ee,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:no,formatHex:no,formatHex8:Va,formatHsl:Fa,formatRgb:oo,toString:oo});function no(){return this.rgb().formatHex()}function Va(){return this.rgb().formatHex8()}function Fa(){return or(this).formatHsl()}function oo(){return this.rgb().formatRgb()}function Ee(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Da.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?ro(e):n===3?new st(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?ze(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?ze(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Ra.exec(t))?new st(e[1],e[2],e[3],1):(e=Ia.exec(t))?new st(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Ha.exec(t))?ze(e[1],e[2],e[3],e[4]):(e=La.exec(t))?ze(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Ba.exec(t))?ao(e[1],e[2]/100,e[3]/100,1):(e=Oa.exec(t))?ao(e[1],e[2]/100,e[3]/100,e[4]):eo.hasOwnProperty(t)?ro(eo[t]):t==="transparent"?new st(NaN,NaN,NaN,0):null}function ro(t){return new st(t>>16&255,t>>8&255,t&255,1)}function ze(t,e,n,o){return o<=0&&(t=e=n=NaN),new st(t,e,n,o)}function Xa(t){return t instanceof $e||(t=Ee(t)),t?(t=t.rgb(),new st(t.r,t.g,t.b,t.opacity)):new st}function vn(t,e,n,o){return arguments.length===1?Xa(t):new st(t,e,n,o??1)}function st(t,e,n,o){this.r=+t,this.g=+e,this.b=+n,this.opacity=+o}In(st,vn,nr($e,{brighter(t){return t=t==null?je:Math.pow(je,t),new st(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?_e:Math.pow(_e,t),new st(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new st(Yt(this.r),Yt(this.g),Yt(this.b),Ze(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:io,formatHex:io,formatHex8:Ya,formatRgb:so,toString:so}));function io(){return`#${Xt(this.r)}${Xt(this.g)}${Xt(this.b)}`}function Ya(){return`#${Xt(this.r)}${Xt(this.g)}${Xt(this.b)}${Xt((isNaN(this.opacity)?1:this.opacity)*255)}`}function so(){const t=Ze(this.opacity);return`${t===1?"rgb(":"rgba("}${Yt(this.r)}, ${Yt(this.g)}, ${Yt(this.b)}${t===1?")":`, ${t})`}`}function Ze(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Yt(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Xt(t){return t=Yt(t),(t<16?"0":"")+t.toString(16)}function ao(t,e,n,o){return o<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new gt(t,e,n,o)}function or(t){if(t instanceof gt)return new gt(t.h,t.s,t.l,t.opacity);if(t instanceof $e||(t=Ee(t)),!t)return new gt;if(t instanceof gt)return t;t=t.rgb();var e=t.r/255,n=t.g/255,o=t.b/255,r=Math.min(e,n,o),s=Math.max(e,n,o),i=NaN,a=s-r,c=(s+r)/2;return a?(e===s?i=(n-o)/a+(n<o)*6:n===s?i=(o-e)/a+2:i=(e-n)/a+4,a/=c<.5?s+r:2-s-r,i*=60):a=c>0&&c<1?0:i,new gt(i,a,c,t.opacity)}function ja(t,e,n,o){return arguments.length===1?or(t):new gt(t,e,n,o??1)}function gt(t,e,n,o){this.h=+t,this.s=+e,this.l=+n,this.opacity=+o}In(gt,ja,nr($e,{brighter(t){return t=t==null?je:Math.pow(je,t),new gt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?_e:Math.pow(_e,t),new gt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,o=n+(n<.5?n:1-n)*e,r=2*n-o;return new st(un(t>=240?t-240:t+120,r,o),un(t,r,o),un(t<120?t+240:t-120,r,o),this.opacity)},clamp(){return new gt(co(this.h),De(this.s),De(this.l),Ze(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Ze(this.opacity);return`${t===1?"hsl(":"hsla("}${co(this.h)}, ${De(this.s)*100}%, ${De(this.l)*100}%${t===1?")":`, ${t})`}`}}));function co(t){return t=(t||0)%360,t<0?t+360:t}function De(t){return Math.max(0,Math.min(1,t||0))}function un(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const rr=t=>()=>t;function Za(t,e){return function(n){return t+n*e}}function Wa(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(o){return Math.pow(t+o*e,n)}}function Ka(t){return(t=+t)==1?ir:function(e,n){return n-e?Wa(e,n,t):rr(isNaN(e)?n:e)}}function ir(t,e){var n=e-t;return n?Za(t,n):rr(isNaN(t)?e:t)}const lo=function t(e){var n=Ka(e);function o(r,s){var i=n((r=vn(r)).r,(s=vn(s)).r),a=n(r.g,s.g),c=n(r.b,s.b),u=ir(r.opacity,s.opacity);return function(l){return r.r=i(l),r.g=a(l),r.b=c(l),r.opacity=u(l),r+""}}return o.gamma=t,o}(1);function At(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var _n=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,fn=new RegExp(_n.source,"g");function Ua(t){return function(){return t}}function Ga(t){return function(e){return t(e)+""}}function qa(t,e){var n=_n.lastIndex=fn.lastIndex=0,o,r,s,i=-1,a=[],c=[];for(t=t+"",e=e+"";(o=_n.exec(t))&&(r=fn.exec(e));)(s=r.index)>n&&(s=e.slice(n,s),a[i]?a[i]+=s:a[++i]=s),(o=o[0])===(r=r[0])?a[i]?a[i]+=r:a[++i]=r:(a[++i]=null,c.push({i,x:At(o,r)})),n=fn.lastIndex;return n<e.length&&(s=e.slice(n),a[i]?a[i]+=s:a[++i]=s),a.length<2?c[0]?Ga(c[0].x):Ua(e):(e=c.length,function(u){for(var l=0,f;l<e;++l)a[(f=c[l]).i]=f.x(u);return a.join("")})}var uo=180/Math.PI,Sn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function sr(t,e,n,o,r,s){var i,a,c;return(i=Math.sqrt(t*t+e*e))&&(t/=i,e/=i),(c=t*n+e*o)&&(n-=t*c,o-=e*c),(a=Math.sqrt(n*n+o*o))&&(n/=a,o/=a,c/=a),t*o<e*n&&(t=-t,e=-e,c=-c,i=-i),{translateX:r,translateY:s,rotate:Math.atan2(e,t)*uo,skewX:Math.atan(c)*uo,scaleX:i,scaleY:a}}var Re;function Qa(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Sn:sr(e.a,e.b,e.c,e.d,e.e,e.f)}function Ja(t){return t==null||(Re||(Re=document.createElementNS("http://www.w3.org/2000/svg","g")),Re.setAttribute("transform",t),!(t=Re.transform.baseVal.consolidate()))?Sn:(t=t.matrix,sr(t.a,t.b,t.c,t.d,t.e,t.f))}function ar(t,e,n,o){function r(u){return u.length?u.pop()+" ":""}function s(u,l,f,d,h,v){if(u!==f||l!==d){var x=h.push("translate(",null,e,null,n);v.push({i:x-4,x:At(u,f)},{i:x-2,x:At(l,d)})}else(f||d)&&h.push("translate("+f+e+d+n)}function i(u,l,f,d){u!==l?(u-l>180?l+=360:l-u>180&&(u+=360),d.push({i:f.push(r(f)+"rotate(",null,o)-2,x:At(u,l)})):l&&f.push(r(f)+"rotate("+l+o)}function a(u,l,f,d){u!==l?d.push({i:f.push(r(f)+"skewX(",null,o)-2,x:At(u,l)}):l&&f.push(r(f)+"skewX("+l+o)}function c(u,l,f,d,h,v){if(u!==f||l!==d){var x=h.push(r(h)+"scale(",null,",",null,")");v.push({i:x-4,x:At(u,f)},{i:x-2,x:At(l,d)})}else(f!==1||d!==1)&&h.push(r(h)+"scale("+f+","+d+")")}return function(u,l){var f=[],d=[];return u=t(u),l=t(l),s(u.translateX,u.translateY,l.translateX,l.translateY,f,d),i(u.rotate,l.rotate,f,d),a(u.skewX,l.skewX,f,d),c(u.scaleX,u.scaleY,l.scaleX,l.scaleY,f,d),u=l=null,function(h){for(var v=-1,x=d.length,b;++v<x;)f[(b=d[v]).i]=b.x(h);return f.join("")}}}var tc=ar(Qa,"px, ","px)","deg)"),ec=ar(Ja,", ",")",")"),nc=1e-12;function fo(t){return((t=Math.exp(t))+1/t)/2}function oc(t){return((t=Math.exp(t))-1/t)/2}function rc(t){return((t=Math.exp(2*t))-1)/(t+1)}const ic=function t(e,n,o){function r(s,i){var a=s[0],c=s[1],u=s[2],l=i[0],f=i[1],d=i[2],h=l-a,v=f-c,x=h*h+v*v,b,p;if(x<nc)p=Math.log(d/u)/e,b=function(P){return[a+P*h,c+P*v,u*Math.exp(e*P*p)]};else{var S=Math.sqrt(x),$=(d*d-u*u+o*x)/(2*u*n*S),m=(d*d-u*u-o*x)/(2*d*n*S),M=Math.log(Math.sqrt($*$+1)-$),C=Math.log(Math.sqrt(m*m+1)-m);p=(C-M)/e,b=function(P){var D=P*p,I=fo(M),B=u/(n*S)*(I*rc(e*D+M)-oc(M));return[a+B*h,c+B*v,u*I/fo(e*D+M)]}}return b.duration=p*1e3*e/Math.SQRT2,b}return r.rho=function(s){var i=Math.max(.001,+s),a=i*i,c=a*a;return t(i,a,c)},r}(Math.SQRT2,2,4);var ae=0,we=0,ge=0,cr=1e3,We,be,Ke=0,jt=0,tn=0,Ne=typeof performance=="object"&&performance.now?performance:Date,lr=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Hn(){return jt||(lr(sc),jt=Ne.now()+tn)}function sc(){jt=0}function Ue(){this._call=this._time=this._next=null}Ue.prototype=ur.prototype={constructor:Ue,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Hn():+n)+(e==null?0:+e),!this._next&&be!==this&&(be?be._next=this:We=this,be=this),this._call=t,this._time=n,En()},stop:function(){this._call&&(this._call=null,this._time=1/0,En())}};function ur(t,e,n){var o=new Ue;return o.restart(t,e,n),o}function ac(){Hn(),++ae;for(var t=We,e;t;)(e=jt-t._time)>=0&&t._call.call(void 0,e),t=t._next;--ae}function ho(){jt=(Ke=Ne.now())+tn,ae=we=0;try{ac()}finally{ae=0,lc(),jt=0}}function cc(){var t=Ne.now(),e=t-Ke;e>cr&&(tn-=e,Ke=t)}function lc(){for(var t,e=We,n,o=1/0;e;)e._call?(o>e._time&&(o=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:We=n);be=t,En(o)}function En(t){if(!ae){we&&(we=clearTimeout(we));var e=t-jt;e>24?(t<1/0&&(we=setTimeout(ho,t-Ne.now()-tn)),ge&&(ge=clearInterval(ge))):(ge||(Ke=Ne.now(),ge=setInterval(cc,cr)),ae=1,lr(ho))}}function go(t,e,n){var o=new Ue;return e=e==null?0:+e,o.restart(r=>{o.stop(),t(r+e)},e,n),o}var uc=Qe("start","end","cancel","interrupt"),fc=[],fr=0,po=1,Nn=2,Ve=3,yo=4,Mn=5,Fe=6;function en(t,e,n,o,r,s){var i=t.__transition;if(!i)t.__transition={};else if(n in i)return;dc(t,n,{name:e,index:o,group:r,on:uc,tween:fc,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:fr})}function Ln(t,e){var n=yt(t,e);if(n.state>fr)throw new Error("too late; already scheduled");return n}function bt(t,e){var n=yt(t,e);if(n.state>Ve)throw new Error("too late; already running");return n}function yt(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function dc(t,e,n){var o=t.__transition,r;o[e]=n,n.timer=ur(s,0,n.time);function s(u){n.state=po,n.timer.restart(i,n.delay,n.time),n.delay<=u&&i(u-n.delay)}function i(u){var l,f,d,h;if(n.state!==po)return c();for(l in o)if(h=o[l],h.name===n.name){if(h.state===Ve)return go(i);h.state===yo?(h.state=Fe,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete o[l]):+l<e&&(h.state=Fe,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete o[l])}if(go(function(){n.state===Ve&&(n.state=yo,n.timer.restart(a,n.delay,n.time),a(u))}),n.state=Nn,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Nn){for(n.state=Ve,r=new Array(d=n.tween.length),l=0,f=-1;l<d;++l)(h=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(r[++f]=h);r.length=f+1}}function a(u){for(var l=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(c),n.state=Mn,1),f=-1,d=r.length;++f<d;)r[f].call(t,l);n.state===Mn&&(n.on.call("end",t,t.__data__,n.index,n.group),c())}function c(){n.state=Fe,n.timer.stop(),delete o[e];for(var u in o)return;delete t.__transition}}function Xe(t,e){var n=t.__transition,o,r,s=!0,i;if(n){e=e==null?null:e+"";for(i in n){if((o=n[i]).name!==e){s=!1;continue}r=o.state>Nn&&o.state<Mn,o.state=Fe,o.timer.stop(),o.on.call(r?"interrupt":"cancel",t,t.__data__,o.index,o.group),delete n[i]}s&&delete t.__transition}}function hc(t){return this.each(function(){Xe(this,t)})}function gc(t,e){var n,o;return function(){var r=bt(this,t),s=r.tween;if(s!==n){o=n=s;for(var i=0,a=o.length;i<a;++i)if(o[i].name===e){o=o.slice(),o.splice(i,1);break}}r.tween=o}}function pc(t,e,n){var o,r;if(typeof n!="function")throw new Error;return function(){var s=bt(this,t),i=s.tween;if(i!==o){r=(o=i).slice();for(var a={name:e,value:n},c=0,u=r.length;c<u;++c)if(r[c].name===e){r[c]=a;break}c===u&&r.push(a)}s.tween=r}}function yc(t,e){var n=this._id;if(t+="",arguments.length<2){for(var o=yt(this.node(),n).tween,r=0,s=o.length,i;r<s;++r)if((i=o[r]).name===t)return i.value;return null}return this.each((e==null?gc:pc)(n,t,e))}function Bn(t,e,n){var o=t._id;return t.each(function(){var r=bt(this,o);(r.value||(r.value={}))[e]=n.apply(this,arguments)}),function(r){return yt(r,o).value[e]}}function dr(t,e){var n;return(typeof e=="number"?At:e instanceof Ee?lo:(n=Ee(e))?(e=n,lo):qa)(t,e)}function mc(t){return function(){this.removeAttribute(t)}}function xc(t){return function(){this.removeAttributeNS(t.space,t.local)}}function wc(t,e,n){var o,r=n+"",s;return function(){var i=this.getAttribute(t);return i===r?null:i===o?s:s=e(o=i,n)}}function bc(t,e,n){var o,r=n+"",s;return function(){var i=this.getAttributeNS(t.space,t.local);return i===r?null:i===o?s:s=e(o=i,n)}}function vc(t,e,n){var o,r,s;return function(){var i,a=n(this),c;return a==null?void this.removeAttribute(t):(i=this.getAttribute(t),c=a+"",i===c?null:i===o&&c===r?s:(r=c,s=e(o=i,a)))}}function _c(t,e,n){var o,r,s;return function(){var i,a=n(this),c;return a==null?void this.removeAttributeNS(t.space,t.local):(i=this.getAttributeNS(t.space,t.local),c=a+"",i===c?null:i===o&&c===r?s:(r=c,s=e(o=i,a)))}}function Sc(t,e){var n=Je(t),o=n==="transform"?ec:dr;return this.attrTween(t,typeof e=="function"?(n.local?_c:vc)(n,o,Bn(this,"attr."+t,e)):e==null?(n.local?xc:mc)(n):(n.local?bc:wc)(n,o,e))}function Ec(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Nc(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Mc(t,e){var n,o;function r(){var s=e.apply(this,arguments);return s!==o&&(n=(o=s)&&Nc(t,s)),n}return r._value=e,r}function Cc(t,e){var n,o;function r(){var s=e.apply(this,arguments);return s!==o&&(n=(o=s)&&Ec(t,s)),n}return r._value=e,r}function Ac(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var o=Je(t);return this.tween(n,(o.local?Mc:Cc)(o,e))}function $c(t,e){return function(){Ln(this,t).delay=+e.apply(this,arguments)}}function kc(t,e){return e=+e,function(){Ln(this,t).delay=e}}function Tc(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?$c:kc)(e,t)):yt(this.node(),e).delay}function Pc(t,e){return function(){bt(this,t).duration=+e.apply(this,arguments)}}function zc(t,e){return e=+e,function(){bt(this,t).duration=e}}function Dc(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Pc:zc)(e,t)):yt(this.node(),e).duration}function Rc(t,e){if(typeof e!="function")throw new Error;return function(){bt(this,t).ease=e}}function Ic(t){var e=this._id;return arguments.length?this.each(Rc(e,t)):yt(this.node(),e).ease}function Hc(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;bt(this,t).ease=n}}function Lc(t){if(typeof t!="function")throw new Error;return this.each(Hc(this._id,t))}function Bc(t){typeof t!="function"&&(t=Yo(t));for(var e=this._groups,n=e.length,o=new Array(n),r=0;r<n;++r)for(var s=e[r],i=s.length,a=o[r]=[],c,u=0;u<i;++u)(c=s[u])&&t.call(c,c.__data__,u,s)&&a.push(c);return new St(o,this._parents,this._name,this._id)}function Oc(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,o=e.length,r=n.length,s=Math.min(o,r),i=new Array(o),a=0;a<s;++a)for(var c=e[a],u=n[a],l=c.length,f=i[a]=new Array(l),d,h=0;h<l;++h)(d=c[h]||u[h])&&(f[h]=d);for(;a<o;++a)i[a]=e[a];return new St(i,this._parents,this._name,this._id)}function Vc(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Fc(t,e,n){var o,r,s=Vc(e)?Ln:bt;return function(){var i=s(this,t),a=i.on;a!==o&&(r=(o=a).copy()).on(e,n),i.on=r}}function Xc(t,e){var n=this._id;return arguments.length<2?yt(this.node(),n).on.on(t):this.each(Fc(n,t,e))}function Yc(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function jc(){return this.on("end.remove",Yc(this._id))}function Zc(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Dn(t));for(var o=this._groups,r=o.length,s=new Array(r),i=0;i<r;++i)for(var a=o[i],c=a.length,u=s[i]=new Array(c),l,f,d=0;d<c;++d)(l=a[d])&&(f=t.call(l,l.__data__,d,a))&&("__data__"in l&&(f.__data__=l.__data__),u[d]=f,en(u[d],e,n,d,u,yt(l,n)));return new St(s,this._parents,e,n)}function Wc(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Xo(t));for(var o=this._groups,r=o.length,s=[],i=[],a=0;a<r;++a)for(var c=o[a],u=c.length,l,f=0;f<u;++f)if(l=c[f]){for(var d=t.call(l,l.__data__,f,c),h,v=yt(l,n),x=0,b=d.length;x<b;++x)(h=d[x])&&en(h,e,n,x,d,v);s.push(d),i.push(l)}return new St(s,i,e,n)}var Kc=Ae.prototype.constructor;function Uc(){return new Kc(this._groups,this._parents)}function Gc(t,e){var n,o,r;return function(){var s=se(this,t),i=(this.style.removeProperty(t),se(this,t));return s===i?null:s===n&&i===o?r:r=e(n=s,o=i)}}function hr(t){return function(){this.style.removeProperty(t)}}function qc(t,e,n){var o,r=n+"",s;return function(){var i=se(this,t);return i===r?null:i===o?s:s=e(o=i,n)}}function Qc(t,e,n){var o,r,s;return function(){var i=se(this,t),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(t),se(this,t))),i===c?null:i===o&&c===r?s:(r=c,s=e(o=i,a))}}function Jc(t,e){var n,o,r,s="style."+e,i="end."+s,a;return function(){var c=bt(this,t),u=c.on,l=c.value[s]==null?a||(a=hr(e)):void 0;(u!==n||r!==l)&&(o=(n=u).copy()).on(i,r=l),c.on=o}}function tl(t,e,n){var o=(t+="")=="transform"?tc:dr;return e==null?this.styleTween(t,Gc(t,o)).on("end.style."+t,hr(t)):typeof e=="function"?this.styleTween(t,Qc(t,o,Bn(this,"style."+t,e))).each(Jc(this._id,t)):this.styleTween(t,qc(t,o,e),n).on("end.style."+t,null)}function el(t,e,n){return function(o){this.style.setProperty(t,e.call(this,o),n)}}function nl(t,e,n){var o,r;function s(){var i=e.apply(this,arguments);return i!==r&&(o=(r=i)&&el(t,i,n)),o}return s._value=e,s}function ol(t,e,n){var o="style."+(t+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(e==null)return this.tween(o,null);if(typeof e!="function")throw new Error;return this.tween(o,nl(t,e,n??""))}function rl(t){return function(){this.textContent=t}}function il(t){return function(){var e=t(this);this.textContent=e??""}}function sl(t){return this.tween("text",typeof t=="function"?il(Bn(this,"text",t)):rl(t==null?"":t+""))}function al(t){return function(e){this.textContent=t.call(this,e)}}function cl(t){var e,n;function o(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&al(r)),e}return o._value=t,o}function ll(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,cl(t))}function ul(){for(var t=this._name,e=this._id,n=gr(),o=this._groups,r=o.length,s=0;s<r;++s)for(var i=o[s],a=i.length,c,u=0;u<a;++u)if(c=i[u]){var l=yt(c,e);en(c,t,n,u,i,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new St(o,this._parents,t,n)}function fl(){var t,e,n=this,o=n._id,r=n.size();return new Promise(function(s,i){var a={value:i},c={value:function(){--r===0&&s()}};n.each(function(){var u=bt(this,o),l=u.on;l!==t&&(e=(t=l).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(c)),u.on=e}),r===0&&s()})}var dl=0;function St(t,e,n,o){this._groups=t,this._parents=e,this._name=n,this._id=o}function gr(){return++dl}var vt=Ae.prototype;St.prototype={constructor:St,select:Zc,selectAll:Wc,selectChild:vt.selectChild,selectChildren:vt.selectChildren,filter:Bc,merge:Oc,selection:Uc,transition:ul,call:vt.call,nodes:vt.nodes,node:vt.node,size:vt.size,empty:vt.empty,each:vt.each,on:Xc,attr:Sc,attrTween:Ac,style:tl,styleTween:ol,text:sl,textTween:ll,remove:jc,tween:yc,delay:Tc,duration:Dc,ease:Ic,easeVarying:Lc,end:fl,[Symbol.iterator]:vt[Symbol.iterator]};function hl(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var gl={time:null,delay:0,duration:250,ease:hl};function pl(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function yl(t){var e,n;t instanceof St?(e=t._id,t=t._name):(e=gr(),(n=gl).time=Hn(),t=t==null?null:t+"");for(var o=this._groups,r=o.length,s=0;s<r;++s)for(var i=o[s],a=i.length,c,u=0;u<a;++u)(c=i[u])&&en(c,t,e,u,i,n||pl(c,e));return new St(o,this._parents,t,e)}Ae.prototype.interrupt=hc;Ae.prototype.transition=yl;const Ie=t=>()=>t;function ml(t,{sourceEvent:e,target:n,transform:o,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:r}})}function _t(t,e,n){this.k=t,this.x=e,this.y=n}_t.prototype={constructor:_t,scale:function(t){return t===1?this:new _t(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new _t(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Tt=new _t(1,0,0);_t.prototype;function dn(t){t.stopImmediatePropagation()}function pe(t){t.preventDefault(),t.stopImmediatePropagation()}function xl(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function wl(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function mo(){return this.__zoom||Tt}function bl(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function vl(){return navigator.maxTouchPoints||"ontouchstart"in this}function _l(t,e,n){var o=t.invertX(e[0][0])-n[0][0],r=t.invertX(e[1][0])-n[1][0],s=t.invertY(e[0][1])-n[0][1],i=t.invertY(e[1][1])-n[1][1];return t.translate(r>o?(o+r)/2:Math.min(0,o)||Math.max(0,r),i>s?(s+i)/2:Math.min(0,s)||Math.max(0,i))}function Sl(){var t=xl,e=wl,n=_l,o=bl,r=vl,s=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],a=250,c=ic,u=Qe("start","zoom","end"),l,f,d,h=500,v=150,x=0,b=10;function p(g){g.property("__zoom",mo).on("wheel.zoom",D,{passive:!1}).on("mousedown.zoom",I).on("dblclick.zoom",B).filter(r).on("touchstart.zoom",R).on("touchmove.zoom",H).on("touchend.zoom touchcancel.zoom",k).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}p.transform=function(g,N,w,y){var _=g.selection?g.selection():g;_.property("__zoom",mo),g!==_?M(g,N,w,y):_.interrupt().each(function(){C(this,arguments).event(y).start().zoom(null,typeof N=="function"?N.apply(this,arguments):N).end()})},p.scaleBy=function(g,N,w,y){p.scaleTo(g,function(){var _=this.__zoom.k,T=typeof N=="function"?N.apply(this,arguments):N;return _*T},w,y)},p.scaleTo=function(g,N,w,y){p.transform(g,function(){var _=e.apply(this,arguments),T=this.__zoom,z=w==null?m(_):typeof w=="function"?w.apply(this,arguments):w,L=T.invert(z),O=typeof N=="function"?N.apply(this,arguments):N;return n($(S(T,O),z,L),_,i)},w,y)},p.translateBy=function(g,N,w,y){p.transform(g,function(){return n(this.__zoom.translate(typeof N=="function"?N.apply(this,arguments):N,typeof w=="function"?w.apply(this,arguments):w),e.apply(this,arguments),i)},null,y)},p.translateTo=function(g,N,w,y,_){p.transform(g,function(){var T=e.apply(this,arguments),z=this.__zoom,L=y==null?m(T):typeof y=="function"?y.apply(this,arguments):y;return n(Tt.translate(L[0],L[1]).scale(z.k).translate(typeof N=="function"?-N.apply(this,arguments):-N,typeof w=="function"?-w.apply(this,arguments):-w),T,i)},y,_)};function S(g,N){return N=Math.max(s[0],Math.min(s[1],N)),N===g.k?g:new _t(N,g.x,g.y)}function $(g,N,w){var y=N[0]-w[0]*g.k,_=N[1]-w[1]*g.k;return y===g.x&&_===g.y?g:new _t(g.k,y,_)}function m(g){return[(+g[0][0]+ +g[1][0])/2,(+g[0][1]+ +g[1][1])/2]}function M(g,N,w,y){g.on("start.zoom",function(){C(this,arguments).event(y).start()}).on("interrupt.zoom end.zoom",function(){C(this,arguments).event(y).end()}).tween("zoom",function(){var _=this,T=arguments,z=C(_,T).event(y),L=e.apply(_,T),O=w==null?m(L):typeof w=="function"?w.apply(_,T):w,Y=Math.max(L[1][0]-L[0][0],L[1][1]-L[0][1]),X=_.__zoom,Z=typeof N=="function"?N.apply(_,T):N,W=c(X.invert(O).concat(Y/X.k),Z.invert(O).concat(Y/Z.k));return function(K){if(K===1)K=Z;else{var U=W(K),J=Y/U[2];K=new _t(J,O[0]-U[0]*J,O[1]-U[1]*J)}z.zoom(null,K)}})}function C(g,N,w){return!w&&g.__zooming||new P(g,N)}function P(g,N){this.that=g,this.args=N,this.active=0,this.sourceEvent=null,this.extent=e.apply(g,N),this.taps=0}P.prototype={event:function(g){return g&&(this.sourceEvent=g),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(g,N){return this.mouse&&g!=="mouse"&&(this.mouse[1]=N.invert(this.mouse[0])),this.touch0&&g!=="touch"&&(this.touch0[1]=N.invert(this.touch0[0])),this.touch1&&g!=="touch"&&(this.touch1[1]=N.invert(this.touch1[0])),this.that.__zoom=N,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(g){var N=ht(this.that).datum();u.call(g,this.that,new ml(g,{sourceEvent:this.sourceEvent,target:p,type:g,transform:this.that.__zoom,dispatch:u}),N)}};function D(g,...N){if(!t.apply(this,arguments))return;var w=C(this,N).event(g),y=this.__zoom,_=Math.max(s[0],Math.min(s[1],y.k*Math.pow(2,o.apply(this,arguments)))),T=xt(g);if(w.wheel)(w.mouse[0][0]!==T[0]||w.mouse[0][1]!==T[1])&&(w.mouse[1]=y.invert(w.mouse[0]=T)),clearTimeout(w.wheel);else{if(y.k===_)return;w.mouse=[T,y.invert(T)],Xe(this),w.start()}pe(g),w.wheel=setTimeout(z,v),w.zoom("mouse",n($(S(y,_),w.mouse[0],w.mouse[1]),w.extent,i));function z(){w.wheel=null,w.end()}}function I(g,...N){if(d||!t.apply(this,arguments))return;var w=g.currentTarget,y=C(this,N,!0).event(g),_=ht(g.view).on("mousemove.zoom",O,!0).on("mouseup.zoom",Y,!0),T=xt(g,w),z=g.clientX,L=g.clientY;tr(g.view),dn(g),y.mouse=[T,this.__zoom.invert(T)],Xe(this),y.start();function O(X){if(pe(X),!y.moved){var Z=X.clientX-z,W=X.clientY-L;y.moved=Z*Z+W*W>x}y.event(X).zoom("mouse",n($(y.that.__zoom,y.mouse[0]=xt(X,w),y.mouse[1]),y.extent,i))}function Y(X){_.on("mousemove.zoom mouseup.zoom",null),er(X.view,y.moved),pe(X),y.event(X).end()}}function B(g,...N){if(t.apply(this,arguments)){var w=this.__zoom,y=xt(g.changedTouches?g.changedTouches[0]:g,this),_=w.invert(y),T=w.k*(g.shiftKey?.5:2),z=n($(S(w,T),y,_),e.apply(this,N),i);pe(g),a>0?ht(this).transition().duration(a).call(M,z,y,g):ht(this).call(p.transform,z,y,g)}}function R(g,...N){if(t.apply(this,arguments)){var w=g.touches,y=w.length,_=C(this,N,g.changedTouches.length===y).event(g),T,z,L,O;for(dn(g),z=0;z<y;++z)L=w[z],O=xt(L,this),O=[O,this.__zoom.invert(O),L.identifier],_.touch0?!_.touch1&&_.touch0[2]!==O[2]&&(_.touch1=O,_.taps=0):(_.touch0=O,T=!0,_.taps=1+!!l);l&&(l=clearTimeout(l)),T&&(_.taps<2&&(f=O[0],l=setTimeout(function(){l=null},h)),Xe(this),_.start())}}function H(g,...N){if(this.__zooming){var w=C(this,N).event(g),y=g.changedTouches,_=y.length,T,z,L,O;for(pe(g),T=0;T<_;++T)z=y[T],L=xt(z,this),w.touch0&&w.touch0[2]===z.identifier?w.touch0[0]=L:w.touch1&&w.touch1[2]===z.identifier&&(w.touch1[0]=L);if(z=w.that.__zoom,w.touch1){var Y=w.touch0[0],X=w.touch0[1],Z=w.touch1[0],W=w.touch1[1],K=(K=Z[0]-Y[0])*K+(K=Z[1]-Y[1])*K,U=(U=W[0]-X[0])*U+(U=W[1]-X[1])*U;z=S(z,Math.sqrt(K/U)),L=[(Y[0]+Z[0])/2,(Y[1]+Z[1])/2],O=[(X[0]+W[0])/2,(X[1]+W[1])/2]}else if(w.touch0)L=w.touch0[0],O=w.touch0[1];else return;w.zoom("touch",n($(z,L,O),w.extent,i))}}function k(g,...N){if(this.__zooming){var w=C(this,N).event(g),y=g.changedTouches,_=y.length,T,z;for(dn(g),d&&clearTimeout(d),d=setTimeout(function(){d=null},h),T=0;T<_;++T)z=y[T],w.touch0&&w.touch0[2]===z.identifier?delete w.touch0:w.touch1&&w.touch1[2]===z.identifier&&delete w.touch1;if(w.touch1&&!w.touch0&&(w.touch0=w.touch1,delete w.touch1),w.touch0)w.touch0[1]=this.__zoom.invert(w.touch0[0]);else if(w.end(),w.taps===2&&(z=xt(z,this),Math.hypot(f[0]-z[0],f[1]-z[1])<b)){var L=ht(this).on("dblclick.zoom");L&&L.apply(this,arguments)}}}return p.wheelDelta=function(g){return arguments.length?(o=typeof g=="function"?g:Ie(+g),p):o},p.filter=function(g){return arguments.length?(t=typeof g=="function"?g:Ie(!!g),p):t},p.touchable=function(g){return arguments.length?(r=typeof g=="function"?g:Ie(!!g),p):r},p.extent=function(g){return arguments.length?(e=typeof g=="function"?g:Ie([[+g[0][0],+g[0][1]],[+g[1][0],+g[1][1]]]),p):e},p.scaleExtent=function(g){return arguments.length?(s[0]=+g[0],s[1]=+g[1],p):[s[0],s[1]]},p.translateExtent=function(g){return arguments.length?(i[0][0]=+g[0][0],i[1][0]=+g[1][0],i[0][1]=+g[0][1],i[1][1]=+g[1][1],p):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},p.constrain=function(g){return arguments.length?(n=g,p):n},p.duration=function(g){return arguments.length?(a=+g,p):a},p.interpolate=function(g){return arguments.length?(c=g,p):c},p.on=function(){var g=u.on.apply(u,arguments);return g===u?p:g},p.clickDistance=function(g){return arguments.length?(x=(g=+g)*g,p):Math.sqrt(x)},p.tapDistance=function(g){return arguments.length?(b=+g,p):b},p}const nn=E.createContext(null),El=nn.Provider,zt={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:t=>`Node type "${t}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:t=>`The old edge with id=${t} does not exist.`,error009:t=>`Marker type "${t}" doesn't exist.`,error008:(t,e)=>`Couldn't create edge for ${t?"target":"source"} handle id: "${t?e.targetHandle:e.sourceHandle}", edge id: ${e.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:t=>`Edge type "${t}" not found. Using fallback type "default".`},pr=zt.error001();function q(t,e){const n=E.useContext(nn);if(n===null)throw new Error(pr);return ji(n,t,e)}const nt=()=>{const t=E.useContext(nn);if(t===null)throw new Error(pr);return E.useMemo(()=>({getState:t.getState,setState:t.setState,subscribe:t.subscribe,destroy:t.destroy}),[t])},Nl=t=>t.userSelectionActive?"none":"all";function Ml({position:t,children:e,className:n,style:o,...r}){const s=q(Nl),i=`${t}`.split("-");return A.jsx("div",{className:ct(["react-flow__panel",n,...i]),style:{...o,pointerEvents:s},...r,children:e})}function Cl({proOptions:t,position:e="bottom-right"}){return t!=null&&t.hideAttribution?null:A.jsx(Ml,{position:e,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:A.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const Al=({x:t,y:e,label:n,labelStyle:o={},labelShowBg:r=!0,labelBgStyle:s={},labelBgPadding:i=[2,4],labelBgBorderRadius:a=2,children:c,className:u,...l})=>{const f=E.useRef(null),[d,h]=E.useState({x:0,y:0,width:0,height:0}),v=ct(["react-flow__edge-textwrapper",u]);return E.useEffect(()=>{if(f.current){const x=f.current.getBBox();h({x:x.x,y:x.y,width:x.width,height:x.height})}},[n]),typeof n>"u"||!n?null:A.jsxs("g",{transform:`translate(${t-d.width/2} ${e-d.height/2})`,className:v,visibility:d.width?"visible":"hidden",...l,children:[r&&A.jsx("rect",{width:d.width+2*i[0],x:-i[0],y:-i[1],height:d.height+2*i[1],className:"react-flow__edge-textbg",style:s,rx:a,ry:a}),A.jsx("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:f,style:o,children:n}),c]})};var $l=E.memo(Al);const On=t=>({width:t.offsetWidth,height:t.offsetHeight}),ce=(t,e=0,n=1)=>Math.min(Math.max(t,e),n),Vn=(t={x:0,y:0},e)=>({x:ce(t.x,e[0][0],e[1][0]),y:ce(t.y,e[0][1],e[1][1])}),xo=(t,e,n)=>t<e?ce(Math.abs(t-e),1,50)/50:t>n?-ce(Math.abs(t-n),1,50)/50:0,yr=(t,e)=>{const n=xo(t.x,35,e.width-35)*20,o=xo(t.y,35,e.height-35)*20;return[n,o]},mr=t=>{var e;return((e=t.getRootNode)==null?void 0:e.call(t))||(window==null?void 0:window.document)},kl=(t,e)=>({x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x2,e.x2),y2:Math.max(t.y2,e.y2)}),xr=({x:t,y:e,width:n,height:o})=>({x:t,y:e,x2:t+n,y2:e+o}),Tl=({x:t,y:e,x2:n,y2:o})=>({x:t,y:e,width:n-t,height:o-e}),wo=t=>({...t.positionAbsolute||{x:0,y:0},width:t.width||0,height:t.height||0}),Cn=(t,e)=>{const n=Math.max(0,Math.min(t.x+t.width,e.x+e.width)-Math.max(t.x,e.x)),o=Math.max(0,Math.min(t.y+t.height,e.y+e.height)-Math.max(t.y,e.y));return Math.ceil(n*o)},Pl=t=>ut(t.width)&&ut(t.height)&&ut(t.x)&&ut(t.y),ut=t=>!isNaN(t)&&isFinite(t),et=Symbol.for("internals"),wr=["Enter"," ","Escape"],zl=(t,e)=>{},Dl=t=>"nativeEvent"in t;function An(t){var r,s;const e=Dl(t)?t.nativeEvent:t,n=((s=(r=e.composedPath)==null?void 0:r.call(e))==null?void 0:s[0])||t.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))||!!(n!=null&&n.closest(".nokey"))}const br=t=>"clientX"in t,Pt=(t,e)=>{var s,i;const n=br(t),o=n?t.clientX:(s=t.touches)==null?void 0:s[0].clientX,r=n?t.clientY:(i=t.touches)==null?void 0:i[0].clientY;return{x:o-((e==null?void 0:e.left)??0),y:r-((e==null?void 0:e.top)??0)}},ke=({id:t,path:e,labelX:n,labelY:o,label:r,labelStyle:s,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:f,markerStart:d,interactionWidth:h=20})=>A.jsxs(A.Fragment,{children:[A.jsx("path",{id:t,style:l,d:e,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:d}),h&&A.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:h,className:"react-flow__edge-interaction"}),r&&ut(n)&&ut(o)?A.jsx($l,{x:n,y:o,label:r,labelStyle:s,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u}):null]});ke.displayName="BaseEdge";function ye(t,e,n){return n===void 0?n:o=>{const r=e().edges.find(s=>s.id===t);r&&n(o,{...r})}}function vr({sourceX:t,sourceY:e,targetX:n,targetY:o}){const r=Math.abs(n-t)/2,s=n<t?n+r:n-r,i=Math.abs(o-e)/2,a=o<e?o+i:o-i;return[s,a,r,i]}function _r({sourceX:t,sourceY:e,targetX:n,targetY:o,sourceControlX:r,sourceControlY:s,targetControlX:i,targetControlY:a}){const c=t*.125+r*.375+i*.375+n*.125,u=e*.125+s*.375+a*.375+o*.125,l=Math.abs(c-t),f=Math.abs(u-e);return[c,u,l,f]}var Zt;(function(t){t.Strict="strict",t.Loose="loose"})(Zt||(Zt={}));var oe;(function(t){t.Free="free",t.Vertical="vertical",t.Horizontal="horizontal"})(oe||(oe={}));var Me;(function(t){t.Partial="partial",t.Full="full"})(Me||(Me={}));var kt;(function(t){t.Bezier="default",t.Straight="straight",t.Step="step",t.SmoothStep="smoothstep",t.SimpleBezier="simplebezier"})(kt||(kt={}));var Ge;(function(t){t.Arrow="arrow",t.ArrowClosed="arrowclosed"})(Ge||(Ge={}));var V;(function(t){t.Left="left",t.Top="top",t.Right="right",t.Bottom="bottom"})(V||(V={}));function bo({pos:t,x1:e,y1:n,x2:o,y2:r}){return t===V.Left||t===V.Right?[.5*(e+o),n]:[e,.5*(n+r)]}function Sr({sourceX:t,sourceY:e,sourcePosition:n=V.Bottom,targetX:o,targetY:r,targetPosition:s=V.Top}){const[i,a]=bo({pos:n,x1:t,y1:e,x2:o,y2:r}),[c,u]=bo({pos:s,x1:o,y1:r,x2:t,y2:e}),[l,f,d,h]=_r({sourceX:t,sourceY:e,targetX:o,targetY:r,sourceControlX:i,sourceControlY:a,targetControlX:c,targetControlY:u});return[`M${t},${e} C${i},${a} ${c},${u} ${o},${r}`,l,f,d,h]}const Fn=E.memo(({sourceX:t,sourceY:e,targetX:n,targetY:o,sourcePosition:r=V.Bottom,targetPosition:s=V.Top,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:f,style:d,markerEnd:h,markerStart:v,interactionWidth:x})=>{const[b,p,S]=Sr({sourceX:t,sourceY:e,sourcePosition:r,targetX:n,targetY:o,targetPosition:s});return A.jsx(ke,{path:b,labelX:p,labelY:S,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:f,style:d,markerEnd:h,markerStart:v,interactionWidth:x})});Fn.displayName="SimpleBezierEdge";const vo={[V.Left]:{x:-1,y:0},[V.Right]:{x:1,y:0},[V.Top]:{x:0,y:-1},[V.Bottom]:{x:0,y:1}},Rl=({source:t,sourcePosition:e=V.Bottom,target:n})=>e===V.Left||e===V.Right?t.x<n.x?{x:1,y:0}:{x:-1,y:0}:t.y<n.y?{x:0,y:1}:{x:0,y:-1},_o=(t,e)=>Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));function Il({source:t,sourcePosition:e=V.Bottom,target:n,targetPosition:o=V.Top,center:r,offset:s}){const i=vo[e],a=vo[o],c={x:t.x+i.x*s,y:t.y+i.y*s},u={x:n.x+a.x*s,y:n.y+a.y*s},l=Rl({source:c,sourcePosition:e,target:u}),f=l.x!==0?"x":"y",d=l[f];let h=[],v,x;const[b,p,S,$]=vr({sourceX:t.x,sourceY:t.y,targetX:n.x,targetY:n.y});if(i[f]*a[f]===-1){v=r.x||b,x=r.y||p;const M=[{x:v,y:c.y},{x:v,y:u.y}],C=[{x:c.x,y:x},{x:u.x,y:x}];i[f]===d?h=f==="x"?M:C:h=f==="x"?C:M}else{const M=[{x:c.x,y:u.y}],C=[{x:u.x,y:c.y}];if(f==="x"?h=i.x===d?C:M:h=i.y===d?M:C,e!==o){const P=f==="x"?"y":"x",D=i[f]===a[P],I=c[P]>u[P],B=c[P]<u[P];(i[f]===1&&(!D&&I||D&&B)||i[f]!==1&&(!D&&B||D&&I))&&(h=f==="x"?M:C)}v=h[0].x,x=h[0].y}return[[t,c,...h,u,n],v,x,S,$]}function Hl(t,e,n,o){const r=Math.min(_o(t,e)/2,_o(e,n)/2,o),{x:s,y:i}=e;if(t.x===s&&s===n.x||t.y===i&&i===n.y)return`L${s} ${i}`;if(t.y===i){const u=t.x<n.x?-1:1,l=t.y<n.y?1:-1;return`L ${s+r*u},${i}Q ${s},${i} ${s},${i+r*l}`}const a=t.x<n.x?1:-1,c=t.y<n.y?-1:1;return`L ${s},${i+r*c}Q ${s},${i} ${s+r*a},${i}`}function $n({sourceX:t,sourceY:e,sourcePosition:n=V.Bottom,targetX:o,targetY:r,targetPosition:s=V.Top,borderRadius:i=5,centerX:a,centerY:c,offset:u=20}){const[l,f,d,h,v]=Il({source:{x:t,y:e},sourcePosition:n,target:{x:o,y:r},targetPosition:s,center:{x:a,y:c},offset:u});return[l.reduce((b,p,S)=>{let $="";return S>0&&S<l.length-1?$=Hl(l[S-1],p,l[S+1],i):$=`${S===0?"M":"L"}${p.x} ${p.y}`,b+=$,b},""),f,d,h,v]}const on=E.memo(({sourceX:t,sourceY:e,targetX:n,targetY:o,label:r,labelStyle:s,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,sourcePosition:f=V.Bottom,targetPosition:d=V.Top,markerEnd:h,markerStart:v,pathOptions:x,interactionWidth:b})=>{const[p,S,$]=$n({sourceX:t,sourceY:e,sourcePosition:f,targetX:n,targetY:o,targetPosition:d,borderRadius:x==null?void 0:x.borderRadius,offset:x==null?void 0:x.offset});return A.jsx(ke,{path:p,labelX:S,labelY:$,label:r,labelStyle:s,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:h,markerStart:v,interactionWidth:b})});on.displayName="SmoothStepEdge";const Xn=E.memo(t=>{var e;return A.jsx(on,{...t,pathOptions:E.useMemo(()=>{var n;return{borderRadius:0,offset:(n=t.pathOptions)==null?void 0:n.offset}},[(e=t.pathOptions)==null?void 0:e.offset])})});Xn.displayName="StepEdge";function Ll({sourceX:t,sourceY:e,targetX:n,targetY:o}){const[r,s,i,a]=vr({sourceX:t,sourceY:e,targetX:n,targetY:o});return[`M ${t},${e}L ${n},${o}`,r,s,i,a]}const Yn=E.memo(({sourceX:t,sourceY:e,targetX:n,targetY:o,label:r,labelStyle:s,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:f,markerStart:d,interactionWidth:h})=>{const[v,x,b]=Ll({sourceX:t,sourceY:e,targetX:n,targetY:o});return A.jsx(ke,{path:v,labelX:x,labelY:b,label:r,labelStyle:s,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:f,markerStart:d,interactionWidth:h})});Yn.displayName="StraightEdge";function He(t,e){return t>=0?.5*t:e*25*Math.sqrt(-t)}function So({pos:t,x1:e,y1:n,x2:o,y2:r,c:s}){switch(t){case V.Left:return[e-He(e-o,s),n];case V.Right:return[e+He(o-e,s),n];case V.Top:return[e,n-He(n-r,s)];case V.Bottom:return[e,n+He(r-n,s)]}}function Er({sourceX:t,sourceY:e,sourcePosition:n=V.Bottom,targetX:o,targetY:r,targetPosition:s=V.Top,curvature:i=.25}){const[a,c]=So({pos:n,x1:t,y1:e,x2:o,y2:r,c:i}),[u,l]=So({pos:s,x1:o,y1:r,x2:t,y2:e,c:i}),[f,d,h,v]=_r({sourceX:t,sourceY:e,targetX:o,targetY:r,sourceControlX:a,sourceControlY:c,targetControlX:u,targetControlY:l});return[`M${t},${e} C${a},${c} ${u},${l} ${o},${r}`,f,d,h,v]}const qe=E.memo(({sourceX:t,sourceY:e,targetX:n,targetY:o,sourcePosition:r=V.Bottom,targetPosition:s=V.Top,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:f,style:d,markerEnd:h,markerStart:v,pathOptions:x,interactionWidth:b})=>{const[p,S,$]=Er({sourceX:t,sourceY:e,sourcePosition:r,targetX:n,targetY:o,targetPosition:s,curvature:x==null?void 0:x.curvature});return A.jsx(ke,{path:p,labelX:S,labelY:$,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:f,style:d,markerEnd:h,markerStart:v,interactionWidth:b})});qe.displayName="BezierEdge";const jn=E.createContext(null),Bl=jn.Provider;jn.Consumer;const Ol=()=>E.useContext(jn),Vl=t=>"id"in t&&"source"in t&&"target"in t,Fl=({source:t,sourceHandle:e,target:n,targetHandle:o})=>`reactflow__edge-${t}${e||""}-${n}${o||""}`,kn=(t,e)=>typeof t>"u"?"":typeof t=="string"?t:`${e?`${e}__`:""}${Object.keys(t).sort().map(o=>`${o}=${t[o]}`).join("&")}`,Xl=(t,e)=>e.some(n=>n.source===t.source&&n.target===t.target&&(n.sourceHandle===t.sourceHandle||!n.sourceHandle&&!t.sourceHandle)&&(n.targetHandle===t.targetHandle||!n.targetHandle&&!t.targetHandle)),Yl=(t,e)=>{if(!t.source||!t.target)return e;let n;return Vl(t)?n={...t}:n={...t,id:Fl(t)},Xl(n,e)?e:e.concat(n)},Nr=({x:t,y:e},[n,o,r],s,[i,a])=>{const c={x:(t-n)/r,y:(e-o)/r};return s?{x:i*Math.round(c.x/i),y:a*Math.round(c.y/a)}:c},jl=({x:t,y:e},[n,o,r])=>({x:t*r+n,y:e*r+o}),re=(t,e=[0,0])=>{if(!t)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(t.width??0)*e[0],o=(t.height??0)*e[1],r={x:t.position.x-n,y:t.position.y-o};return{...r,positionAbsolute:t.positionAbsolute?{x:t.positionAbsolute.x-n,y:t.positionAbsolute.y-o}:r}},Mr=(t,e=[0,0])=>{if(t.length===0)return{x:0,y:0,width:0,height:0};const n=t.reduce((o,r)=>{const{x:s,y:i}=re(r,e).positionAbsolute;return kl(o,xr({x:s,y:i,width:r.width||0,height:r.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Tl(n)},Cr=(t,e,[n,o,r]=[0,0,1],s=!1,i=!1,a=[0,0])=>{const c={x:(e.x-n)/r,y:(e.y-o)/r,width:e.width/r,height:e.height/r},u=[];return t.forEach(l=>{const{width:f,height:d,selectable:h=!0,hidden:v=!1}=l;if(i&&!h||v)return!1;const{positionAbsolute:x}=re(l,a),b={x:x.x,y:x.y,width:f||0,height:d||0},p=Cn(c,b),S=typeof f>"u"||typeof d>"u"||f===null||d===null,$=s&&p>0,m=(f||0)*(d||0);(S||$||p>=m||l.dragging)&&u.push(l)}),u},Ar=(t,e)=>{const n=t.map(o=>o.id);return e.filter(o=>n.includes(o.source)||n.includes(o.target))},$r=(t,e,n,o,r,s=.1)=>{const i=e/(t.width*(1+s)),a=n/(t.height*(1+s)),c=Math.min(i,a),u=ce(c,o,r),l=t.x+t.width/2,f=t.y+t.height/2,d=e/2-l*u,h=n/2-f*u;return[d,h,u]},Ft=(t,e=0)=>t.transition().duration(e);function Eo(t,e,n,o){return(e[n]||[]).reduce((r,s)=>{var i,a;return`${t.id}-${s.id}-${n}`!==o&&r.push({id:s.id||null,type:n,nodeId:t.id,x:(((i=t.positionAbsolute)==null?void 0:i.x)??0)+s.x+s.width/2,y:(((a=t.positionAbsolute)==null?void 0:a.y)??0)+s.y+s.height/2}),r},[])}function Zl(t,e,n){let o=[],r=1/0;return n.forEach(s=>{const i=Math.sqrt(Math.pow(s.x-t.x,2)+Math.pow(s.y-t.y,2));i<=e&&(i<r?o=[s]:i===r&&o.push(s),r=i)}),o.length?o.length===1?o[0]:o.find(s=>s.type==="target")||o[0]:null}const Wl={source:null,target:null,sourceHandle:null,targetHandle:null};function kr(t,e,n,o,r,s,i,a){const c=s==="target",u=a.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),{x:l,y:f}=Pt(t),d=a.elementFromPoint(l,f),h=d!=null&&d.classList.contains("react-flow__handle")?d:u,v={handleDomNode:h,isValid:!1,connection:Wl,endHandle:null};if(h){const x=Tr(void 0,h),b=h.getAttribute("data-nodeid"),p=h.getAttribute("data-handleid"),S=h.classList.contains("connectable"),$=h.classList.contains("connectableend"),m={source:c?b:o,sourceHandle:c?p:r,target:c?o:b,targetHandle:c?r:p};v.connection=m,S&&$&&(n===Zt.Strict?c&&x==="source"||!c&&x==="target":b!==o||p!==r)&&(v.endHandle={nodeId:b,handleId:p,type:x},v.isValid=i(m))}return v}function Kl({nodes:t,nodeId:e,handleId:n,handleType:o}){return t.reduce((r,s)=>{if(s[et]){const{handleBounds:i}=s[et];let a=[],c=[];i&&(a=Eo(s,i,"source",`${e}-${n}-${o}`),c=Eo(s,i,"target",`${e}-${n}-${o}`)),r.push(...a,...c)}return r},[])}function Tr(t,e){return t||(e!=null&&e.classList.contains("target")?"target":e!=null&&e.classList.contains("source")?"source":null)}function hn(t){t==null||t.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function Ul(t,e){let n=null;return e?n="valid":t&&!e&&(n="invalid"),n}function Pr({event:t,handleId:e,nodeId:n,onConnect:o,isTarget:r,getState:s,setState:i,isValidConnection:a,edgeUpdaterType:c,onEdgeUpdateEnd:u}){const l=mr(t.target),{connectionMode:f,domNode:d,autoPanOnConnect:h,connectionRadius:v,onConnectStart:x,panBy:b,getNodes:p,cancelConnection:S}=s();let $=0,m;const{x:M,y:C}=Pt(t),P=l==null?void 0:l.elementFromPoint(M,C),D=Tr(c,P),I=d==null?void 0:d.getBoundingClientRect();if(!I||!D)return;let B,R=Pt(t,I),H=!1,k=null,g=!1,N=null;const w=Kl({nodes:p(),nodeId:n,handleId:e,handleType:D}),y=()=>{if(!h)return;const[z,L]=yr(R,I);b({x:z,y:L}),$=requestAnimationFrame(y)};i({connectionPosition:R,connectionStatus:null,connectionNodeId:n,connectionHandleId:e,connectionHandleType:D,connectionStartHandle:{nodeId:n,handleId:e,type:D},connectionEndHandle:null}),x==null||x(t,{nodeId:n,handleId:e,handleType:D});function _(z){const{transform:L}=s();R=Pt(z,I),m=Zl(Nr(R,L,!1,[1,1]),v,w),H||(y(),H=!0);const O=kr(z,m,f,n,e,r?"target":"source",a,l);if(N=O.handleDomNode,k=O.connection,g=O.isValid,i({connectionPosition:m&&g?jl({x:m.x,y:m.y},L):R,connectionStatus:Ul(!!m,g),connectionEndHandle:O.endHandle}),!m&&!g&&!N)return hn(B);k.source!==k.target&&N&&(hn(B),B=N,N.classList.add("connecting","react-flow__handle-connecting"),N.classList.toggle("valid",g),N.classList.toggle("react-flow__handle-valid",g))}function T(z){var L,O;(m||N)&&k&&g&&(o==null||o(k)),(O=(L=s()).onConnectEnd)==null||O.call(L,z),c&&(u==null||u(z)),hn(B),S(),cancelAnimationFrame($),H=!1,g=!1,k=null,N=null,l.removeEventListener("mousemove",_),l.removeEventListener("mouseup",T),l.removeEventListener("touchmove",_),l.removeEventListener("touchend",T)}l.addEventListener("mousemove",_),l.addEventListener("mouseup",T),l.addEventListener("touchmove",_),l.addEventListener("touchend",T)}const No=()=>!0,Gl=t=>({connectionStartHandle:t.connectionStartHandle,connectOnClick:t.connectOnClick,noPanClassName:t.noPanClassName}),ql=(t,e,n)=>o=>{const{connectionStartHandle:r,connectionEndHandle:s,connectionClickStartHandle:i}=o;return{connecting:(r==null?void 0:r.nodeId)===t&&(r==null?void 0:r.handleId)===e&&(r==null?void 0:r.type)===n||(s==null?void 0:s.nodeId)===t&&(s==null?void 0:s.handleId)===e&&(s==null?void 0:s.type)===n,clickConnecting:(i==null?void 0:i.nodeId)===t&&(i==null?void 0:i.handleId)===e&&(i==null?void 0:i.type)===n}},zr=E.forwardRef(({type:t="source",position:e=V.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:r=!0,isConnectableEnd:s=!0,id:i,onConnect:a,children:c,className:u,onMouseDown:l,onTouchStart:f,...d},h)=>{var I,B;const v=i||null,x=t==="target",b=nt(),p=Ol(),{connectOnClick:S,noPanClassName:$}=q(Gl,ot),{connecting:m,clickConnecting:M}=q(ql(p,v,t),ot);p||(B=(I=b.getState()).onError)==null||B.call(I,"010",zt.error010());const C=R=>{const{defaultEdgeOptions:H,onConnect:k,hasDefaultEdges:g}=b.getState(),N={...H,...R};if(g){const{edges:w,setEdges:y}=b.getState();y(Yl(N,w))}k==null||k(N),a==null||a(N)},P=R=>{if(!p)return;const H=br(R);r&&(H&&R.button===0||!H)&&Pr({event:R,handleId:v,nodeId:p,onConnect:C,isTarget:x,getState:b.getState,setState:b.setState,isValidConnection:n||b.getState().isValidConnection||No}),H?l==null||l(R):f==null||f(R)},D=R=>{const{onClickConnectStart:H,onClickConnectEnd:k,connectionClickStartHandle:g,connectionMode:N,isValidConnection:w}=b.getState();if(!p||!g&&!r)return;if(!g){H==null||H(R,{nodeId:p,handleId:v,handleType:t}),b.setState({connectionClickStartHandle:{nodeId:p,type:t,handleId:v}});return}const y=mr(R.target),_=n||w||No,{connection:T,isValid:z}=kr(R,{nodeId:p,id:v,type:t},N,g.nodeId,g.handleId||null,g.type,_,y);z&&C(T),k==null||k(R),b.setState({connectionClickStartHandle:null})};return A.jsx("div",{"data-handleid":v,"data-nodeid":p,"data-handlepos":e,"data-id":`${p}-${v}-${t}`,className:ct(["react-flow__handle",`react-flow__handle-${e}`,"nodrag",$,u,{source:!x,target:x,connectable:o,connectablestart:r,connectableend:s,connecting:M,connectionindicator:o&&(r&&!m||s&&m)}]),onMouseDown:P,onTouchStart:P,onClick:S?D:void 0,ref:h,...d,children:c})});zr.displayName="Handle";var le=E.memo(zr);const Dr=({data:t,isConnectable:e,targetPosition:n=V.Top,sourcePosition:o=V.Bottom})=>A.jsxs(A.Fragment,{children:[A.jsx(le,{type:"target",position:n,isConnectable:e}),t==null?void 0:t.label,A.jsx(le,{type:"source",position:o,isConnectable:e})]});Dr.displayName="DefaultNode";var Tn=E.memo(Dr);const Rr=({data:t,isConnectable:e,sourcePosition:n=V.Bottom})=>A.jsxs(A.Fragment,{children:[t==null?void 0:t.label,A.jsx(le,{type:"source",position:n,isConnectable:e})]});Rr.displayName="InputNode";var Ir=E.memo(Rr);const Hr=({data:t,isConnectable:e,targetPosition:n=V.Top})=>A.jsxs(A.Fragment,{children:[A.jsx(le,{type:"target",position:n,isConnectable:e}),t==null?void 0:t.label]});Hr.displayName="OutputNode";var Lr=E.memo(Hr);const Zn=()=>null;Zn.displayName="GroupNode";const Ql=t=>({selectedNodes:t.getNodes().filter(e=>e.selected),selectedEdges:t.edges.filter(e=>e.selected)}),Le=t=>t.id;function Jl(t,e){return ot(t.selectedNodes.map(Le),e.selectedNodes.map(Le))&&ot(t.selectedEdges.map(Le),e.selectedEdges.map(Le))}const Br=E.memo(({onSelectionChange:t})=>{const e=nt(),{selectedNodes:n,selectedEdges:o}=q(Ql,Jl);return E.useEffect(()=>{var s,i;const r={nodes:n,edges:o};t==null||t(r),(i=(s=e.getState()).onSelectionChange)==null||i.call(s,r)},[n,o,t]),null});Br.displayName="SelectionListener";const tu=t=>!!t.onSelectionChange;function eu({onSelectionChange:t}){const e=q(tu);return t||e?A.jsx(Br,{onSelectionChange:t}):null}const nu=t=>({setNodes:t.setNodes,setEdges:t.setEdges,setDefaultNodesAndEdges:t.setDefaultNodesAndEdges,setMinZoom:t.setMinZoom,setMaxZoom:t.setMaxZoom,setTranslateExtent:t.setTranslateExtent,setNodeExtent:t.setNodeExtent,reset:t.reset});function Gt(t,e){E.useEffect(()=>{typeof t<"u"&&e(t)},[t])}function j(t,e,n){E.useEffect(()=>{typeof e<"u"&&n({[t]:e})},[e])}const ou=({nodes:t,edges:e,defaultNodes:n,defaultEdges:o,onConnect:r,onConnectStart:s,onConnectEnd:i,onClickConnectStart:a,onClickConnectEnd:c,nodesDraggable:u,nodesConnectable:l,nodesFocusable:f,edgesFocusable:d,edgesUpdatable:h,elevateNodesOnSelect:v,minZoom:x,maxZoom:b,nodeExtent:p,onNodesChange:S,onEdgesChange:$,elementsSelectable:m,connectionMode:M,snapGrid:C,snapToGrid:P,translateExtent:D,connectOnClick:I,defaultEdgeOptions:B,fitView:R,fitViewOptions:H,onNodesDelete:k,onEdgesDelete:g,onNodeDrag:N,onNodeDragStart:w,onNodeDragStop:y,onSelectionDrag:_,onSelectionDragStart:T,onSelectionDragStop:z,noPanClassName:L,nodeOrigin:O,rfId:Y,autoPanOnConnect:X,autoPanOnNodeDrag:Z,onError:W,connectionRadius:K,isValidConnection:U})=>{const{setNodes:J,setEdges:Q,setDefaultNodesAndEdges:lt,setMinZoom:ft,setMaxZoom:mt,setTranslateExtent:tt,setNodeExtent:G,reset:rt}=q(nu,ot),F=nt();return E.useEffect(()=>{const Et=o==null?void 0:o.map(Dt=>({...Dt,...B}));return lt(n,Et),()=>{rt()}},[]),j("defaultEdgeOptions",B,F.setState),j("connectionMode",M,F.setState),j("onConnect",r,F.setState),j("onConnectStart",s,F.setState),j("onConnectEnd",i,F.setState),j("onClickConnectStart",a,F.setState),j("onClickConnectEnd",c,F.setState),j("nodesDraggable",u,F.setState),j("nodesConnectable",l,F.setState),j("nodesFocusable",f,F.setState),j("edgesFocusable",d,F.setState),j("edgesUpdatable",h,F.setState),j("elementsSelectable",m,F.setState),j("elevateNodesOnSelect",v,F.setState),j("snapToGrid",P,F.setState),j("snapGrid",C,F.setState),j("onNodesChange",S,F.setState),j("onEdgesChange",$,F.setState),j("connectOnClick",I,F.setState),j("fitViewOnInit",R,F.setState),j("fitViewOnInitOptions",H,F.setState),j("onNodesDelete",k,F.setState),j("onEdgesDelete",g,F.setState),j("onNodeDrag",N,F.setState),j("onNodeDragStart",w,F.setState),j("onNodeDragStop",y,F.setState),j("onSelectionDrag",_,F.setState),j("onSelectionDragStart",T,F.setState),j("onSelectionDragStop",z,F.setState),j("noPanClassName",L,F.setState),j("nodeOrigin",O,F.setState),j("rfId",Y,F.setState),j("autoPanOnConnect",X,F.setState),j("autoPanOnNodeDrag",Z,F.setState),j("onError",W,F.setState),j("connectionRadius",K,F.setState),j("isValidConnection",U,F.setState),Gt(t,J),Gt(e,Q),Gt(x,ft),Gt(b,mt),Gt(D,tt),Gt(p,G),null},Mo={display:"none"},ru={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Or="react-flow__node-desc",Vr="react-flow__edge-desc",iu="react-flow__aria-live",su=t=>t.ariaLiveMessage;function au({rfId:t}){const e=q(su);return A.jsx("div",{id:`${iu}-${t}`,"aria-live":"assertive","aria-atomic":"true",style:ru,children:e})}function cu({rfId:t,disableKeyboardA11y:e}){return A.jsxs(A.Fragment,{children:[A.jsxs("div",{id:`${Or}-${t}`,style:Mo,children:["Press enter or space to select a node.",!e&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),A.jsx("div",{id:`${Vr}-${t}`,style:Mo,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!e&&A.jsx(au,{rfId:t})]})}const lu=(t,e,n)=>n===V.Left?t-e:n===V.Right?t+e:t,uu=(t,e,n)=>n===V.Top?t-e:n===V.Bottom?t+e:t,Co="react-flow__edgeupdater",Ao=({position:t,centerX:e,centerY:n,radius:o=10,onMouseDown:r,onMouseEnter:s,onMouseOut:i,type:a})=>A.jsx("circle",{onMouseDown:r,onMouseEnter:s,onMouseOut:i,className:ct([Co,`${Co}-${a}`]),cx:lu(e,o,t),cy:uu(n,o,t),r:o,stroke:"transparent",fill:"transparent"}),fu=()=>!0;var qt=t=>{const e=({id:n,className:o,type:r,data:s,onClick:i,onEdgeDoubleClick:a,selected:c,animated:u,label:l,labelStyle:f,labelShowBg:d,labelBgStyle:h,labelBgPadding:v,labelBgBorderRadius:x,style:b,source:p,target:S,sourceX:$,sourceY:m,targetX:M,targetY:C,sourcePosition:P,targetPosition:D,elementsSelectable:I,hidden:B,sourceHandleId:R,targetHandleId:H,onContextMenu:k,onMouseEnter:g,onMouseMove:N,onMouseLeave:w,edgeUpdaterRadius:y,onEdgeUpdate:_,onEdgeUpdateStart:T,onEdgeUpdateEnd:z,markerEnd:L,markerStart:O,rfId:Y,ariaLabel:X,isFocusable:Z,isUpdatable:W,pathOptions:K,interactionWidth:U})=>{const J=E.useRef(null),[Q,lt]=E.useState(!1),[ft,mt]=E.useState(!1),tt=nt(),G=E.useMemo(()=>`url(#${kn(O,Y)})`,[O,Y]),rt=E.useMemo(()=>`url(#${kn(L,Y)})`,[L,Y]);if(B)return null;const F=it=>{const{edges:dt,addSelectedEdges:Ht}=tt.getState();if(I&&(tt.setState({nodesSelectionActive:!1}),Ht([n])),i){const Lt=dt.find(Bt=>Bt.id===n);i(it,Lt)}},Et=ye(n,tt.getState,a),Dt=ye(n,tt.getState,k),ue=ye(n,tt.getState,g),fe=ye(n,tt.getState,N),Wt=ye(n,tt.getState,w),Rt=(it,dt)=>{if(it.button!==0)return;const{edges:Ht,isValidConnection:Lt}=tt.getState(),Bt=dt?S:p,Te=(dt?H:R)||null,Ot=dt?"target":"source",rn=Lt||fu,sn=dt,he=Ht.find(Vt=>Vt.id===n);mt(!0),T==null||T(it,he,Ot);const an=Vt=>{mt(!1),z==null||z(Vt,he,Ot)};Pr({event:it,handleId:Te,nodeId:Bt,onConnect:Vt=>_==null?void 0:_(he,Vt),isTarget:sn,getState:tt.getState,setState:tt.setState,isValidConnection:rn,edgeUpdaterType:Ot,onEdgeUpdateEnd:an})},Nt=it=>Rt(it,!0),Kt=it=>Rt(it,!1),Mt=()=>lt(!0),It=()=>lt(!1),de=!I&&!i,Ut=it=>{var dt;if(wr.includes(it.key)&&I){const{unselectNodesAndEdges:Ht,addSelectedEdges:Lt,edges:Bt}=tt.getState();it.key==="Escape"?((dt=J.current)==null||dt.blur(),Ht({edges:[Bt.find(Ot=>Ot.id===n)]})):Lt([n])}};return A.jsxs("g",{className:ct(["react-flow__edge",`react-flow__edge-${r}`,o,{selected:c,animated:u,inactive:de,updating:Q}]),onClick:F,onDoubleClick:Et,onContextMenu:Dt,onMouseEnter:ue,onMouseMove:fe,onMouseLeave:Wt,onKeyDown:Z?Ut:void 0,tabIndex:Z?0:void 0,role:Z?"button":void 0,"data-testid":`rf__edge-${n}`,"aria-label":X===null?void 0:X||`Edge from ${p} to ${S}`,"aria-describedby":Z?`${Vr}-${Y}`:void 0,ref:J,children:[!ft&&A.jsx(t,{id:n,source:p,target:S,selected:c,animated:u,label:l,labelStyle:f,labelShowBg:d,labelBgStyle:h,labelBgPadding:v,labelBgBorderRadius:x,data:s,style:b,sourceX:$,sourceY:m,targetX:M,targetY:C,sourcePosition:P,targetPosition:D,sourceHandleId:R,targetHandleId:H,markerStart:G,markerEnd:rt,pathOptions:K,interactionWidth:U}),W&&A.jsxs(A.Fragment,{children:[(W==="source"||W===!0)&&A.jsx(Ao,{position:P,centerX:$,centerY:m,radius:y,onMouseDown:Nt,onMouseEnter:Mt,onMouseOut:It,type:"source"}),(W==="target"||W===!0)&&A.jsx(Ao,{position:D,centerX:M,centerY:C,radius:y,onMouseDown:Kt,onMouseEnter:Mt,onMouseOut:It,type:"target"})]})]})};return e.displayName="EdgeWrapper",E.memo(e)};function du(t){const e={default:qt(t.default||qe),straight:qt(t.bezier||Yn),step:qt(t.step||Xn),smoothstep:qt(t.step||on),simplebezier:qt(t.simplebezier||Fn)},n={},o=Object.keys(t).filter(r=>!["default","bezier"].includes(r)).reduce((r,s)=>(r[s]=qt(t[s]||qe),r),n);return{...e,...o}}function $o(t,e,n=null){const o=((n==null?void 0:n.x)||0)+e.x,r=((n==null?void 0:n.y)||0)+e.y,s=(n==null?void 0:n.width)||e.width,i=(n==null?void 0:n.height)||e.height;switch(t){case V.Top:return{x:o+s/2,y:r};case V.Right:return{x:o+s,y:r+i/2};case V.Bottom:return{x:o+s/2,y:r+i};case V.Left:return{x:o,y:r+i/2}}}function ko(t,e){return t?t.length===1||!e?t[0]:e&&t.find(n=>n.id===e)||null:null}const hu=(t,e,n,o,r,s)=>{const i=$o(n,t,e),a=$o(s,o,r);return{sourceX:i.x,sourceY:i.y,targetX:a.x,targetY:a.y}};function gu({sourcePos:t,targetPos:e,sourceWidth:n,sourceHeight:o,targetWidth:r,targetHeight:s,width:i,height:a,transform:c}){const u={x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x+n,e.x+r),y2:Math.max(t.y+o,e.y+s)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const l=xr({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:i/c[2],height:a/c[2]}),f=Math.max(0,Math.min(l.x2,u.x2)-Math.max(l.x,u.x)),d=Math.max(0,Math.min(l.y2,u.y2)-Math.max(l.y,u.y));return Math.ceil(f*d)>0}function To(t){var o,r,s,i,a;const e=((o=t==null?void 0:t[et])==null?void 0:o.handleBounds)||null,n=e&&(t==null?void 0:t.width)&&(t==null?void 0:t.height)&&typeof((r=t==null?void 0:t.positionAbsolute)==null?void 0:r.x)<"u"&&typeof((s=t==null?void 0:t.positionAbsolute)==null?void 0:s.y)<"u";return[{x:((i=t==null?void 0:t.positionAbsolute)==null?void 0:i.x)||0,y:((a=t==null?void 0:t.positionAbsolute)==null?void 0:a.y)||0,width:(t==null?void 0:t.width)||0,height:(t==null?void 0:t.height)||0},e,!!n]}function Fr(t,e){if(!t.parentNode)return!1;const n=e.get(t.parentNode);return n?n.selected?!0:Fr(n,e):!1}function Po(t,e,n){let o=t;do{if(o!=null&&o.matches(e))return!0;if(o===n.current)return!1;o=o.parentElement}while(o);return!1}function pu(t,e,n,o){return Array.from(t.values()).filter(r=>(r.selected||r.id===o)&&(!r.parentNode||!Fr(r,t))&&(r.draggable||e&&typeof r.draggable>"u")).map(r=>{var s,i;return{id:r.id,position:r.position||{x:0,y:0},positionAbsolute:r.positionAbsolute||{x:0,y:0},distance:{x:n.x-(((s=r.positionAbsolute)==null?void 0:s.x)??0),y:n.y-(((i=r.positionAbsolute)==null?void 0:i.y)??0)},delta:{x:0,y:0},extent:r.extent,parentNode:r.parentNode,width:r.width,height:r.height}})}function Xr(t,e,n,o,r=[0,0],s){let i=t.extent||o;if(t.extent==="parent")if(t.parentNode&&t.width&&t.height){const u=n.get(t.parentNode),{x:l,y:f}=re(u,r).positionAbsolute;i=u&&ut(l)&&ut(f)&&ut(u.width)&&ut(u.height)?[[l+t.width*r[0],f+t.height*r[1]],[l+u.width-t.width+t.width*r[0],f+u.height-t.height+t.height*r[1]]]:i}else s==null||s("005",zt.error005()),i=o;else if(t.extent&&t.parentNode){const u=n.get(t.parentNode),{x:l,y:f}=re(u,r).positionAbsolute;i=[[t.extent[0][0]+l,t.extent[0][1]+f],[t.extent[1][0]+l,t.extent[1][1]+f]]}let a={x:0,y:0};if(t.parentNode){const u=n.get(t.parentNode);a=re(u,r).positionAbsolute}const c=i?Vn(e,i):e;return{position:{x:c.x-a.x,y:c.y-a.y},positionAbsolute:c}}function gn({nodeId:t,dragItems:e,nodeInternals:n}){const o=e.map(r=>({...n.get(r.id),position:r.position,positionAbsolute:r.positionAbsolute}));return[t?o.find(r=>r.id===t):o[0],o]}const zo=(t,e,n,o)=>{const r=e.querySelectorAll(t);if(!r||!r.length)return null;const s=Array.from(r),i=e.getBoundingClientRect(),a={x:i.width*o[0],y:i.height*o[1]};return s.map(c=>{const u=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(u.left-i.left-a.x)/n,y:(u.top-i.top-a.y)/n,...On(c)}})};function me(t,e,n){return n===void 0?n:o=>{const r=e().nodeInternals.get(t);n(o,{...r})}}function Pn({id:t,store:e,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:r,unselectNodesAndEdges:s,multiSelectionActive:i,nodeInternals:a}=e.getState(),c=a.get(t);e.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&i)&&(s({nodes:[c]}),requestAnimationFrame(()=>{var u;return(u=o==null?void 0:o.current)==null?void 0:u.blur()})):r([t])}function yu(){const t=nt();return E.useCallback(({sourceEvent:n})=>{const{transform:o,snapGrid:r,snapToGrid:s}=t.getState(),i=n.touches?n.touches[0].clientX:n.clientX,a=n.touches?n.touches[0].clientY:n.clientY,c={x:(i-o[0])/o[2],y:(a-o[1])/o[2]};return{xSnapped:s?r[0]*Math.round(c.x/r[0]):c.x,ySnapped:s?r[1]*Math.round(c.y/r[1]):c.y,...c}},[])}function pn(t){return(e,n,o)=>t==null?void 0:t(e,o)}function Yr({nodeRef:t,disabled:e=!1,noDragClassName:n,handleSelector:o,nodeId:r,isSelectable:s,selectNodesOnDrag:i}){const a=nt(),[c,u]=E.useState(!1),l=E.useRef([]),f=E.useRef({x:null,y:null}),d=E.useRef(0),h=E.useRef(null),v=E.useRef({x:0,y:0}),x=E.useRef(null),b=E.useRef(!1),p=yu();return E.useEffect(()=>{if(t!=null&&t.current){const S=ht(t.current),$=({x:M,y:C})=>{const{nodeInternals:P,onNodeDrag:D,onSelectionDrag:I,updateNodePositions:B,nodeExtent:R,snapGrid:H,snapToGrid:k,nodeOrigin:g,onError:N}=a.getState();f.current={x:M,y:C};let w=!1;if(l.current=l.current.map(_=>{const T={x:M-_.distance.x,y:C-_.distance.y};k&&(T.x=H[0]*Math.round(T.x/H[0]),T.y=H[1]*Math.round(T.y/H[1]));const z=Xr(_,T,P,R,g,N);return w=w||_.position.x!==z.position.x||_.position.y!==z.position.y,_.position=z.position,_.positionAbsolute=z.positionAbsolute,_}),!w)return;B(l.current,!0,!0),u(!0);const y=r?D:pn(I);if(y&&x.current){const[_,T]=gn({nodeId:r,dragItems:l.current,nodeInternals:P});y(x.current,_,T)}},m=()=>{if(!h.current)return;const[M,C]=yr(v.current,h.current);if(M!==0||C!==0){const{transform:P,panBy:D}=a.getState();f.current.x=(f.current.x??0)-M/P[2],f.current.y=(f.current.y??0)-C/P[2],D({x:M,y:C})&&$(f.current)}d.current=requestAnimationFrame(m)};if(e)S.on(".drag",null);else{const M=za().on("start",C=>{var w;const{nodeInternals:P,multiSelectionActive:D,domNode:I,nodesDraggable:B,unselectNodesAndEdges:R,onNodeDragStart:H,onSelectionDragStart:k}=a.getState(),g=r?H:pn(k);!i&&!D&&r&&((w=P.get(r))!=null&&w.selected||R()),r&&s&&i&&Pn({id:r,store:a,nodeRef:t});const N=p(C);if(f.current=N,l.current=pu(P,B,N,r),g&&l.current){const[y,_]=gn({nodeId:r,dragItems:l.current,nodeInternals:P});g(C.sourceEvent,y,_)}h.current=(I==null?void 0:I.getBoundingClientRect())||null,v.current=Pt(C.sourceEvent,h.current)}).on("drag",C=>{const P=p(C),{autoPanOnNodeDrag:D}=a.getState();!b.current&&D&&(b.current=!0,m()),(f.current.x!==P.xSnapped||f.current.y!==P.ySnapped)&&l.current&&(x.current=C.sourceEvent,v.current=Pt(C.sourceEvent,h.current),$(P))}).on("end",C=>{if(u(!1),b.current=!1,cancelAnimationFrame(d.current),l.current){const{updateNodePositions:P,nodeInternals:D,onNodeDragStop:I,onSelectionDragStop:B}=a.getState(),R=r?I:pn(B);if(P(l.current,!1,!1),R){const[H,k]=gn({nodeId:r,dragItems:l.current,nodeInternals:D});R(C.sourceEvent,H,k)}}}).filter(C=>{const P=C.target;return!C.button&&(!n||!Po(P,`.${n}`,t))&&(!o||Po(P,o,t))});return S.call(M),()=>{S.on(".drag",null)}}}},[t,e,n,o,s,a,r,i,p]),c}function jr(){const t=nt();return E.useCallback(n=>{const{nodeInternals:o,nodeExtent:r,updateNodePositions:s,getNodes:i,snapToGrid:a,snapGrid:c,onError:u,nodesDraggable:l}=t.getState(),f=i().filter(S=>S.selected&&(S.draggable||l&&typeof S.draggable>"u")),d=a?c[0]:5,h=a?c[1]:5,v=n.isShiftPressed?4:1,x=n.x*d*v,b=n.y*h*v,p=f.map(S=>{if(S.positionAbsolute){const $={x:S.positionAbsolute.x+x,y:S.positionAbsolute.y+b};a&&($.x=c[0]*Math.round($.x/c[0]),$.y=c[1]*Math.round($.y/c[1]));const{positionAbsolute:m,position:M}=Xr(S,$,o,r,void 0,u);S.position=M,S.positionAbsolute=m}return S});s(p,!0,!1)},[])}const ie={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var xe=t=>{const e=({id:n,type:o,data:r,xPos:s,yPos:i,xPosOrigin:a,yPosOrigin:c,selected:u,onClick:l,onMouseEnter:f,onMouseMove:d,onMouseLeave:h,onContextMenu:v,onDoubleClick:x,style:b,className:p,isDraggable:S,isSelectable:$,isConnectable:m,isFocusable:M,selectNodesOnDrag:C,sourcePosition:P,targetPosition:D,hidden:I,resizeObserver:B,dragHandle:R,zIndex:H,isParent:k,noDragClassName:g,noPanClassName:N,initialized:w,disableKeyboardA11y:y,ariaLabel:_,rfId:T})=>{const z=nt(),L=E.useRef(null),O=E.useRef(P),Y=E.useRef(D),X=E.useRef(o),Z=$||S||l||f||d||h,W=jr(),K=me(n,z.getState,f),U=me(n,z.getState,d),J=me(n,z.getState,h),Q=me(n,z.getState,v),lt=me(n,z.getState,x),ft=G=>{if($&&(!C||!S)&&Pn({id:n,store:z,nodeRef:L}),l){const rt=z.getState().nodeInternals.get(n);l(G,{...rt})}},mt=G=>{if(!An(G))if(wr.includes(G.key)&&$){const rt=G.key==="Escape";Pn({id:n,store:z,unselect:rt,nodeRef:L})}else!y&&S&&u&&Object.prototype.hasOwnProperty.call(ie,G.key)&&(z.setState({ariaLiveMessage:`Moved selected node ${G.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~s}, y: ${~~i}`}),W({x:ie[G.key].x,y:ie[G.key].y,isShiftPressed:G.shiftKey}))};E.useEffect(()=>{if(L.current&&!I){const G=L.current;return B==null||B.observe(G),()=>B==null?void 0:B.unobserve(G)}},[I]),E.useEffect(()=>{const G=X.current!==o,rt=O.current!==P,F=Y.current!==D;L.current&&(G||rt||F)&&(G&&(X.current=o),rt&&(O.current=P),F&&(Y.current=D),z.getState().updateNodeDimensions([{id:n,nodeElement:L.current,forceUpdate:!0}]))},[n,o,P,D]);const tt=Yr({nodeRef:L,disabled:I||!S,noDragClassName:g,handleSelector:R,nodeId:n,isSelectable:$,selectNodesOnDrag:C});return I?null:A.jsx("div",{className:ct(["react-flow__node",`react-flow__node-${o}`,{[N]:S},p,{selected:u,selectable:$,parent:k,dragging:tt}]),ref:L,style:{zIndex:H,transform:`translate(${a}px,${c}px)`,pointerEvents:Z?"all":"none",visibility:w?"visible":"hidden",...b},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:K,onMouseMove:U,onMouseLeave:J,onContextMenu:Q,onClick:ft,onDoubleClick:lt,onKeyDown:M?mt:void 0,tabIndex:M?0:void 0,role:M?"button":void 0,"aria-describedby":y?void 0:`${Or}-${T}`,"aria-label":_,children:A.jsx(Bl,{value:n,children:A.jsx(t,{id:n,data:r,type:o,xPos:s,yPos:i,selected:u,isConnectable:m,sourcePosition:P,targetPosition:D,dragging:tt,dragHandle:R,zIndex:H})})})};return e.displayName="NodeWrapper",E.memo(e)};function mu(t){const e={input:xe(t.input||Ir),default:xe(t.default||Tn),output:xe(t.output||Lr),group:xe(t.group||Zn)},n={},o=Object.keys(t).filter(r=>!["input","default","output","group"].includes(r)).reduce((r,s)=>(r[s]=xe(t[s]||Tn),r),n);return{...e,...o}}const xu=({x:t,y:e,width:n,height:o,origin:r})=>!n||!o?{x:t,y:e}:r[0]<0||r[1]<0||r[0]>1||r[1]>1?{x:t,y:e}:{x:t-n*r[0],y:e-o*r[1]},wu=typeof document<"u"?document:null;var Ce=(t=null,e={target:wu})=>{const[n,o]=E.useState(!1),r=E.useRef(!1),s=E.useRef(new Set([])),[i,a]=E.useMemo(()=>{if(t!==null){const u=(Array.isArray(t)?t:[t]).filter(f=>typeof f=="string").map(f=>f.split("+")),l=u.reduce((f,d)=>f.concat(...d),[]);return[u,l]}return[[],[]]},[t]);return E.useEffect(()=>{var c,u;if(t!==null){const l=h=>{if(r.current=h.ctrlKey||h.metaKey||h.shiftKey,!r.current&&An(h))return!1;const v=Ro(h.code,a);s.current.add(h[v]),Do(i,s.current,!1)&&(h.preventDefault(),o(!0))},f=h=>{if(!r.current&&An(h))return!1;const v=Ro(h.code,a);Do(i,s.current,!0)?(o(!1),s.current.clear()):s.current.delete(h[v]),r.current=!1},d=()=>{s.current.clear(),o(!1)};return(c=e==null?void 0:e.target)==null||c.addEventListener("keydown",l),(u=e==null?void 0:e.target)==null||u.addEventListener("keyup",f),window.addEventListener("blur",d),()=>{var h,v;(h=e==null?void 0:e.target)==null||h.removeEventListener("keydown",l),(v=e==null?void 0:e.target)==null||v.removeEventListener("keyup",f),window.removeEventListener("blur",d)}}},[t,o]),n};function Do(t,e,n){return t.filter(o=>n||o.length===e.size).some(o=>o.every(r=>e.has(r)))}function Ro(t,e){return e.includes(t)?"code":"key"}function Zr(t,e,n,o){var i,a;if(!t.parentNode)return n;const r=e.get(t.parentNode),s=re(r,o);return Zr(r,e,{x:(n.x??0)+s.x,y:(n.y??0)+s.y,z:(((i=r[et])==null?void 0:i.z)??0)>(n.z??0)?((a=r[et])==null?void 0:a.z)??0:n.z??0},o)}function Wr(t,e,n){t.forEach(o=>{var r;if(o.parentNode&&!t.has(o.parentNode))throw new Error(`Parent node ${o.parentNode} not found`);if(o.parentNode||n!=null&&n[o.id]){const{x:s,y:i,z:a}=Zr(o,t,{...o.position,z:((r=o[et])==null?void 0:r.z)??0},e);o.positionAbsolute={x:s,y:i},o[et].z=a,n!=null&&n[o.id]&&(o[et].isParent=!0)}})}function yn(t,e,n,o){const r=new Map,s={},i=o?1e3:0;return t.forEach(a=>{var f;const c=(ut(a.zIndex)?a.zIndex:0)+(a.selected?i:0),u=e.get(a.id),l={width:u==null?void 0:u.width,height:u==null?void 0:u.height,...a,positionAbsolute:{x:a.position.x,y:a.position.y}};a.parentNode&&(l.parentNode=a.parentNode,s[a.parentNode]=!0),Object.defineProperty(l,et,{enumerable:!1,value:{handleBounds:(f=u==null?void 0:u[et])==null?void 0:f.handleBounds,z:c}}),r.set(a.id,l)}),Wr(r,n,s),r}function Kr(t,e={}){const{getNodes:n,width:o,height:r,minZoom:s,maxZoom:i,d3Zoom:a,d3Selection:c,fitViewOnInitDone:u,fitViewOnInit:l,nodeOrigin:f}=t(),d=e.initial&&!u&&l;if(a&&c&&(d||!e.initial)){const v=n().filter(b=>{var S;const p=e.includeHiddenNodes?b.width&&b.height:!b.hidden;return(S=e.nodes)!=null&&S.length?p&&e.nodes.some($=>$.id===b.id):p}),x=v.every(b=>b.width&&b.height);if(v.length>0&&x){const b=Mr(v,f),[p,S,$]=$r(b,o,r,e.minZoom??s,e.maxZoom??i,e.padding??.1),m=Tt.translate(p,S).scale($);return typeof e.duration=="number"&&e.duration>0?a.transform(Ft(c,e.duration),m):a.transform(c,m),!0}}return!1}function bu(t,e){return t.forEach(n=>{const o=e.get(n.id);o&&e.set(o.id,{...o,[et]:o[et],selected:n.selected})}),new Map(e)}function vu(t,e){return e.map(n=>{const o=t.find(r=>r.id===n.id);return o&&(n.selected=o.selected),n})}function Be({changedNodes:t,changedEdges:e,get:n,set:o}){const{nodeInternals:r,edges:s,onNodesChange:i,onEdgesChange:a,hasDefaultNodes:c,hasDefaultEdges:u}=n();t!=null&&t.length&&(c&&o({nodeInternals:bu(t,r)}),i==null||i(t)),e!=null&&e.length&&(u&&o({edges:vu(e,s)}),a==null||a(e))}const Qt=()=>{},_u={zoomIn:Qt,zoomOut:Qt,zoomTo:Qt,getZoom:()=>1,setViewport:Qt,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Qt,fitBounds:Qt,project:t=>t,viewportInitialized:!1},Su=t=>({d3Zoom:t.d3Zoom,d3Selection:t.d3Selection}),Eu=()=>{const t=nt(),{d3Zoom:e,d3Selection:n}=q(Su,ot);return E.useMemo(()=>n&&e?{zoomIn:r=>e.scaleBy(Ft(n,r==null?void 0:r.duration),1.2),zoomOut:r=>e.scaleBy(Ft(n,r==null?void 0:r.duration),1/1.2),zoomTo:(r,s)=>e.scaleTo(Ft(n,s==null?void 0:s.duration),r),getZoom:()=>t.getState().transform[2],setViewport:(r,s)=>{const[i,a,c]=t.getState().transform,u=Tt.translate(r.x??i,r.y??a).scale(r.zoom??c);e.transform(Ft(n,s==null?void 0:s.duration),u)},getViewport:()=>{const[r,s,i]=t.getState().transform;return{x:r,y:s,zoom:i}},fitView:r=>Kr(t.getState,r),setCenter:(r,s,i)=>{const{width:a,height:c,maxZoom:u}=t.getState(),l=typeof(i==null?void 0:i.zoom)<"u"?i.zoom:u,f=a/2-r*l,d=c/2-s*l,h=Tt.translate(f,d).scale(l);e.transform(Ft(n,i==null?void 0:i.duration),h)},fitBounds:(r,s)=>{const{width:i,height:a,minZoom:c,maxZoom:u}=t.getState(),[l,f,d]=$r(r,i,a,c,u,(s==null?void 0:s.padding)??.1),h=Tt.translate(l,f).scale(d);e.transform(Ft(n,s==null?void 0:s.duration),h)},project:r=>{const{transform:s,snapToGrid:i,snapGrid:a}=t.getState();return Nr(r,s,i,a)},viewportInitialized:!0}:_u,[e,n])};function Ur(){const t=Eu(),e=nt(),n=E.useCallback(()=>e.getState().getNodes().map(x=>({...x})),[]),o=E.useCallback(x=>e.getState().nodeInternals.get(x),[]),r=E.useCallback(()=>{const{edges:x=[]}=e.getState();return x.map(b=>({...b}))},[]),s=E.useCallback(x=>{const{edges:b=[]}=e.getState();return b.find(p=>p.id===x)},[]),i=E.useCallback(x=>{const{getNodes:b,setNodes:p,hasDefaultNodes:S,onNodesChange:$}=e.getState(),m=b(),M=typeof x=="function"?x(m):x;if(S)p(M);else if($){const C=M.length===0?m.map(P=>({type:"remove",id:P.id})):M.map(P=>({item:P,type:"reset"}));$(C)}},[]),a=E.useCallback(x=>{const{edges:b=[],setEdges:p,hasDefaultEdges:S,onEdgesChange:$}=e.getState(),m=typeof x=="function"?x(b):x;if(S)p(m);else if($){const M=m.length===0?b.map(C=>({type:"remove",id:C.id})):m.map(C=>({item:C,type:"reset"}));$(M)}},[]),c=E.useCallback(x=>{const b=Array.isArray(x)?x:[x],{getNodes:p,setNodes:S,hasDefaultNodes:$,onNodesChange:m}=e.getState();if($){const C=[...p(),...b];S(C)}else if(m){const M=b.map(C=>({item:C,type:"add"}));m(M)}},[]),u=E.useCallback(x=>{const b=Array.isArray(x)?x:[x],{edges:p=[],setEdges:S,hasDefaultEdges:$,onEdgesChange:m}=e.getState();if($)S([...p,...b]);else if(m){const M=b.map(C=>({item:C,type:"add"}));m(M)}},[]),l=E.useCallback(()=>{const{getNodes:x,edges:b=[],transform:p}=e.getState(),[S,$,m]=p;return{nodes:x().map(M=>({...M})),edges:b.map(M=>({...M})),viewport:{x:S,y:$,zoom:m}}},[]),f=E.useCallback(({nodes:x,edges:b})=>{const{nodeInternals:p,getNodes:S,edges:$,hasDefaultNodes:m,hasDefaultEdges:M,onNodesDelete:C,onEdgesDelete:P,onNodesChange:D,onEdgesChange:I}=e.getState(),B=(x||[]).map(N=>N.id),R=(b||[]).map(N=>N.id),H=S().reduce((N,w)=>{const y=!B.includes(w.id)&&w.parentNode&&N.find(T=>T.id===w.parentNode);return(typeof w.deletable=="boolean"?w.deletable:!0)&&(B.includes(w.id)||y)&&N.push(w),N},[]),k=$.filter(N=>typeof N.deletable=="boolean"?N.deletable:!0),g=k.filter(N=>R.includes(N.id));if(H||g){const N=Ar(H,k),w=[...g,...N],y=w.reduce((_,T)=>(_.includes(T.id)||_.push(T.id),_),[]);if((M||m)&&(M&&e.setState({edges:$.filter(_=>!y.includes(_.id))}),m&&(H.forEach(_=>{p.delete(_.id)}),e.setState({nodeInternals:new Map(p)}))),y.length>0&&(P==null||P(w),I&&I(y.map(_=>({id:_,type:"remove"})))),H.length>0&&(C==null||C(H),D)){const _=H.map(T=>({id:T.id,type:"remove"}));D(_)}}},[]),d=E.useCallback(x=>{const b=Pl(x),p=b?null:e.getState().nodeInternals.get(x.id);return[b?x:wo(p),p,b]},[]),h=E.useCallback((x,b=!0,p)=>{const[S,$,m]=d(x);return S?(p||e.getState().getNodes()).filter(M=>{if(!m&&(M.id===$.id||!M.positionAbsolute))return!1;const C=wo(M),P=Cn(C,S);return b&&P>0||P>=x.width*x.height}):[]},[]),v=E.useCallback((x,b,p=!0)=>{const[S]=d(x);if(!S)return!1;const $=Cn(S,b);return p&&$>0||$>=x.width*x.height},[]);return E.useMemo(()=>({...t,getNodes:n,getNode:o,getEdges:r,getEdge:s,setNodes:i,setEdges:a,addNodes:c,addEdges:u,toObject:l,deleteElements:f,getIntersectingNodes:h,isNodeIntersecting:v}),[t,n,o,r,s,i,a,c,u,l,f,h,v])}var Nu=({deleteKeyCode:t,multiSelectionKeyCode:e})=>{const n=nt(),{deleteElements:o}=Ur(),r=Ce(t),s=Ce(e);E.useEffect(()=>{if(r){const{edges:i,getNodes:a}=n.getState(),c=a().filter(l=>l.selected),u=i.filter(l=>l.selected);o({nodes:c,edges:u}),n.setState({nodesSelectionActive:!1})}},[r]),E.useEffect(()=>{n.setState({multiSelectionActive:s})},[s])};function Mu(t){const e=nt();E.useEffect(()=>{let n;const o=()=>{var s,i;if(!t.current)return;const r=On(t.current);(r.height===0||r.width===0)&&((i=(s=e.getState()).onError)==null||i.call(s,"004",zt.error004())),e.setState({width:r.width||500,height:r.height||500})};return o(),window.addEventListener("resize",o),t.current&&(n=new ResizeObserver(()=>o()),n.observe(t.current)),()=>{window.removeEventListener("resize",o),n&&t.current&&n.unobserve(t.current)}},[])}const Wn={position:"absolute",width:"100%",height:"100%",top:0,left:0},Cu=(t,e)=>t.x!==e.x||t.y!==e.y||t.zoom!==e.k,mn=t=>({x:t.x,y:t.y,zoom:t.k}),Jt=(t,e)=>t.target.closest(`.${e}`),Io=(t,e)=>e===2&&Array.isArray(t)&&t.includes(2),Au=t=>({d3Zoom:t.d3Zoom,d3Selection:t.d3Selection,d3ZoomHandler:t.d3ZoomHandler,userSelectionActive:t.userSelectionActive}),$u=({onMove:t,onMoveStart:e,onMoveEnd:n,onPaneContextMenu:o,zoomOnScroll:r=!0,zoomOnPinch:s=!0,panOnScroll:i=!1,panOnScrollSpeed:a=.5,panOnScrollMode:c=oe.Free,zoomOnDoubleClick:u=!0,elementsSelectable:l,panOnDrag:f=!0,defaultViewport:d,translateExtent:h,minZoom:v,maxZoom:x,zoomActivationKeyCode:b,preventScrolling:p=!0,children:S,noWheelClassName:$,noPanClassName:m})=>{const M=E.useRef(),C=nt(),P=E.useRef(!1),D=E.useRef(!1),I=E.useRef(null),B=E.useRef({x:0,y:0,zoom:0}),{d3Zoom:R,d3Selection:H,d3ZoomHandler:k,userSelectionActive:g}=q(Au,ot),N=Ce(b),w=E.useRef(0);return Mu(I),E.useEffect(()=>{if(I.current){const y=I.current.getBoundingClientRect(),_=Sl().scaleExtent([v,x]).translateExtent(h),T=ht(I.current).call(_),z=Tt.translate(d.x,d.y).scale(ce(d.zoom,v,x)),L=[[0,0],[y.width,y.height]],O=_.constrain()(z,L,h);_.transform(T,O),C.setState({d3Zoom:_,d3Selection:T,d3ZoomHandler:T.on("wheel.zoom"),transform:[O.x,O.y,O.k],domNode:I.current.closest(".react-flow")})}},[]),E.useEffect(()=>{H&&R&&(i&&!N&&!g?H.on("wheel.zoom",y=>{if(Jt(y,$))return!1;y.preventDefault(),y.stopImmediatePropagation();const _=H.property("__zoom").k||1;if(y.ctrlKey&&s){const O=xt(y),Y=-y.deltaY*(y.deltaMode===1?.05:y.deltaMode?1:.002)*10,X=_*Math.pow(2,Y);R.scaleTo(H,X,O);return}const T=y.deltaMode===1?20:1,z=c===oe.Vertical?0:y.deltaX*T,L=c===oe.Horizontal?0:y.deltaY*T;R.translateBy(H,-(z/_)*a,-(L/_)*a)},{passive:!1}):typeof k<"u"&&H.on("wheel.zoom",function(y,_){if(!p||Jt(y,$))return null;y.preventDefault(),k.call(this,y,_)},{passive:!1}))},[g,i,c,H,R,k,N,s,p,$]),E.useEffect(()=>{R&&R.on("start",y=>{var T;if(!y.sourceEvent)return null;w.current=y.sourceEvent.button;const{onViewportChangeStart:_}=C.getState();if(P.current=!0,((T=y.sourceEvent)==null?void 0:T.type)==="mousedown"&&C.setState({paneDragging:!0}),e||_){const z=mn(y.transform);B.current=z,_==null||_(z),e==null||e(y.sourceEvent,z)}})},[R,e]),E.useEffect(()=>{R&&(g&&!P.current?R.on("zoom",null):g||R.on("zoom",y=>{const{onViewportChange:_}=C.getState();if(C.setState({transform:[y.transform.x,y.transform.y,y.transform.k]}),D.current=!!(o&&Io(f,w.current??0)),t||_){const T=mn(y.transform);_==null||_(T),t==null||t(y.sourceEvent,T)}}))},[g,R,t,f,o]),E.useEffect(()=>{R&&R.on("end",y=>{if(!y.sourceEvent)return null;const{onViewportChangeEnd:_}=C.getState();if(P.current=!1,C.setState({paneDragging:!1}),o&&Io(f,w.current??0)&&!D.current&&o(y.sourceEvent),D.current=!1,(n||_)&&Cu(B.current,y.transform)){const T=mn(y.transform);B.current=T,clearTimeout(M.current),M.current=setTimeout(()=>{_==null||_(T),n==null||n(y.sourceEvent,T)},i?150:0)}})},[R,i,f,n,o]),E.useEffect(()=>{R&&R.filter(y=>{const _=N||r,T=s&&y.ctrlKey;if(y.button===1&&y.type==="mousedown"&&(Jt(y,"react-flow__node")||Jt(y,"react-flow__edge")))return!0;if(!f&&!_&&!i&&!u&&!s||g||!u&&y.type==="dblclick"||Jt(y,$)&&y.type==="wheel"||Jt(y,m)&&y.type!=="wheel"||!s&&y.ctrlKey&&y.type==="wheel"||!_&&!i&&!T&&y.type==="wheel"||!f&&(y.type==="mousedown"||y.type==="touchstart")||Array.isArray(f)&&!f.includes(y.button)&&(y.type==="mousedown"||y.type==="touchstart"))return!1;const z=Array.isArray(f)&&f.includes(y.button)||!y.button||y.button<=1;return(!y.ctrlKey||y.type==="wheel")&&z})},[g,R,r,s,i,u,f,l,N]),A.jsx("div",{className:"react-flow__renderer",ref:I,style:Wn,children:S})},ku=t=>({userSelectionActive:t.userSelectionActive,userSelectionRect:t.userSelectionRect});function Tu(){const{userSelectionActive:t,userSelectionRect:e}=q(ku,ot);return t&&e?A.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:e.width,height:e.height,transform:`translate(${e.x}px, ${e.y}px)`}}):null}function Ho(t,e){const n=t.find(o=>o.id===e.parentNode);if(n){const o=e.position.x+e.width-n.width,r=e.position.y+e.height-n.height;if(o>0||r>0||e.position.x<0||e.position.y<0){if(n.style={...n.style},n.style.width=n.style.width??n.width,n.style.height=n.style.height??n.height,o>0&&(n.style.width+=o),r>0&&(n.style.height+=r),e.position.x<0){const s=Math.abs(e.position.x);n.position.x=n.position.x-s,n.style.width+=s,e.position.x=0}if(e.position.y<0){const s=Math.abs(e.position.y);n.position.y=n.position.y-s,n.style.height+=s,e.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function Pu(t,e){if(t.some(o=>o.type==="reset"))return t.filter(o=>o.type==="reset").map(o=>o.item);const n=t.filter(o=>o.type==="add").map(o=>o.item);return e.reduce((o,r)=>{const s=t.filter(a=>a.id===r.id);if(s.length===0)return o.push(r),o;const i={...r};for(const a of s)if(a)switch(a.type){case"select":{i.selected=a.selected;break}case"position":{typeof a.position<"u"&&(i.position=a.position),typeof a.positionAbsolute<"u"&&(i.positionAbsolute=a.positionAbsolute),typeof a.dragging<"u"&&(i.dragging=a.dragging),i.expandParent&&Ho(o,i);break}case"dimensions":{typeof a.dimensions<"u"&&(i.width=a.dimensions.width,i.height=a.dimensions.height),typeof a.updateStyle<"u"&&(i.style={...i.style||{},...a.dimensions}),typeof a.resizing=="boolean"&&(i.resizing=a.resizing),i.expandParent&&Ho(o,i);break}case"remove":return o}return o.push(i),o},n)}function zu(t,e){return Pu(t,e)}const $t=(t,e)=>({id:t,type:"select",selected:e});function te(t,e){return t.reduce((n,o)=>{const r=e.includes(o.id);return!o.selected&&r?(o.selected=!0,n.push($t(o.id,!0))):o.selected&&!r&&(o.selected=!1,n.push($t(o.id,!1))),n},[])}const xn=(t,e)=>n=>{n.target===e.current&&(t==null||t(n))},Du=t=>({userSelectionActive:t.userSelectionActive,elementsSelectable:t.elementsSelectable,dragging:t.paneDragging}),Gr=E.memo(({isSelecting:t,selectionMode:e=Me.Full,panOnDrag:n,onSelectionStart:o,onSelectionEnd:r,onPaneClick:s,onPaneContextMenu:i,onPaneScroll:a,onPaneMouseEnter:c,onPaneMouseMove:u,onPaneMouseLeave:l,children:f})=>{const d=E.useRef(null),h=nt(),v=E.useRef(0),x=E.useRef(0),b=E.useRef(),{userSelectionActive:p,elementsSelectable:S,dragging:$}=q(Du,ot),m=()=>{h.setState({userSelectionActive:!1,userSelectionRect:null}),v.current=0,x.current=0},M=k=>{s==null||s(k),h.getState().resetSelectedElements(),h.setState({nodesSelectionActive:!1})},C=k=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){k.preventDefault();return}i==null||i(k)},P=a?k=>a(k):void 0,D=k=>{const{resetSelectedElements:g,domNode:N}=h.getState();if(b.current=N==null?void 0:N.getBoundingClientRect(),!S||!t||k.button!==0||k.target!==d.current||!b.current)return;const{x:w,y}=Pt(k,b.current);g(),h.setState({userSelectionRect:{width:0,height:0,startX:w,startY:y,x:w,y}}),o==null||o(k)},I=k=>{const{userSelectionRect:g,nodeInternals:N,edges:w,transform:y,onNodesChange:_,onEdgesChange:T,nodeOrigin:z,getNodes:L}=h.getState();if(!t||!b.current||!g)return;h.setState({userSelectionActive:!0,nodesSelectionActive:!1});const O=Pt(k,b.current),Y=g.startX??0,X=g.startY??0,Z={...g,x:O.x<Y?O.x:Y,y:O.y<X?O.y:X,width:Math.abs(O.x-Y),height:Math.abs(O.y-X)},W=L(),K=Cr(N,Z,y,e===Me.Partial,!0,z),U=Ar(K,w).map(Q=>Q.id),J=K.map(Q=>Q.id);if(v.current!==J.length){v.current=J.length;const Q=te(W,J);Q.length&&(_==null||_(Q))}if(x.current!==U.length){x.current=U.length;const Q=te(w,U);Q.length&&(T==null||T(Q))}h.setState({userSelectionRect:Z})},B=k=>{if(k.button!==0)return;const{userSelectionRect:g}=h.getState();!p&&g&&k.target===d.current&&(M==null||M(k)),h.setState({nodesSelectionActive:v.current>0}),m(),r==null||r(k)},R=k=>{p&&(h.setState({nodesSelectionActive:v.current>0}),r==null||r(k)),m()},H=S&&(t||p);return A.jsxs("div",{className:ct(["react-flow__pane",{dragging:$,selection:t}]),onClick:H?void 0:xn(M,d),onContextMenu:xn(C,d),onWheel:xn(P,d),onMouseEnter:H?void 0:c,onMouseDown:H?D:void 0,onMouseMove:H?I:u,onMouseUp:H?B:void 0,onMouseLeave:H?R:l,ref:d,style:Wn,children:[f,A.jsx(Tu,{})]})});Gr.displayName="Pane";const Ru=t=>{const e=t.getNodes().filter(n=>n.selected);return{...Mr(e,t.nodeOrigin),transformString:`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]})`,userSelectionActive:t.userSelectionActive}};function Iu({onSelectionContextMenu:t,noPanClassName:e,disableKeyboardA11y:n}){const o=nt(),{width:r,height:s,x:i,y:a,transformString:c,userSelectionActive:u}=q(Ru,ot),l=jr(),f=E.useRef(null);if(E.useEffect(()=>{var v;n||(v=f.current)==null||v.focus({preventScroll:!0})},[n]),Yr({nodeRef:f}),u||!r||!s)return null;const d=t?v=>{const x=o.getState().getNodes().filter(b=>b.selected);t(v,x)}:void 0,h=v=>{Object.prototype.hasOwnProperty.call(ie,v.key)&&l({x:ie[v.key].x,y:ie[v.key].y,isShiftPressed:v.shiftKey})};return A.jsx("div",{className:ct(["react-flow__nodesselection","react-flow__container",e]),style:{transform:c},children:A.jsx("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:d,tabIndex:n?void 0:-1,onKeyDown:n?void 0:h,style:{width:r,height:s,top:a,left:i}})})}var Hu=E.memo(Iu);const Lu=t=>t.nodesSelectionActive,qr=({children:t,onPaneClick:e,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:s,onPaneScroll:i,deleteKeyCode:a,onMove:c,onMoveStart:u,onMoveEnd:l,selectionKeyCode:f,selectionOnDrag:d,selectionMode:h,onSelectionStart:v,onSelectionEnd:x,multiSelectionKeyCode:b,panActivationKeyCode:p,zoomActivationKeyCode:S,elementsSelectable:$,zoomOnScroll:m,zoomOnPinch:M,panOnScroll:C,panOnScrollSpeed:P,panOnScrollMode:D,zoomOnDoubleClick:I,panOnDrag:B,defaultViewport:R,translateExtent:H,minZoom:k,maxZoom:g,preventScrolling:N,onSelectionContextMenu:w,noWheelClassName:y,noPanClassName:_,disableKeyboardA11y:T})=>{const z=q(Lu),L=Ce(f),Y=Ce(p)||B,X=L||d&&Y!==!0;return Nu({deleteKeyCode:a,multiSelectionKeyCode:b}),A.jsx($u,{onMove:c,onMoveStart:u,onMoveEnd:l,onPaneContextMenu:s,elementsSelectable:$,zoomOnScroll:m,zoomOnPinch:M,panOnScroll:C,panOnScrollSpeed:P,panOnScrollMode:D,zoomOnDoubleClick:I,panOnDrag:!L&&Y,defaultViewport:R,translateExtent:H,minZoom:k,maxZoom:g,zoomActivationKeyCode:S,preventScrolling:N,noWheelClassName:y,noPanClassName:_,children:A.jsxs(Gr,{onSelectionStart:v,onSelectionEnd:x,onPaneClick:e,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:s,onPaneScroll:i,panOnDrag:Y,isSelecting:!!X,selectionMode:h,children:[t,z&&A.jsx(Hu,{onSelectionContextMenu:w,noPanClassName:_,disableKeyboardA11y:T})]})})};qr.displayName="FlowRenderer";var Bu=E.memo(qr);function Ou(t){return q(E.useCallback(n=>t?Cr(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[t]))}const Vu=t=>({nodesDraggable:t.nodesDraggable,nodesConnectable:t.nodesConnectable,nodesFocusable:t.nodesFocusable,elementsSelectable:t.elementsSelectable,updateNodeDimensions:t.updateNodeDimensions,onError:t.onError}),Qr=t=>{const{nodesDraggable:e,nodesConnectable:n,nodesFocusable:o,elementsSelectable:r,updateNodeDimensions:s,onError:i}=q(Vu,ot),a=Ou(t.onlyRenderVisibleElements),c=E.useRef(),u=E.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const l=new ResizeObserver(f=>{const d=f.map(h=>({id:h.target.getAttribute("data-id"),nodeElement:h.target,forceUpdate:!0}));s(d)});return c.current=l,l},[]);return E.useEffect(()=>()=>{var l;(l=c==null?void 0:c.current)==null||l.disconnect()},[]),A.jsx("div",{className:"react-flow__nodes",style:Wn,children:a.map(l=>{var M,C;let f=l.type||"default";t.nodeTypes[f]||(i==null||i("003",zt.error003(f)),f="default");const d=t.nodeTypes[f]||t.nodeTypes.default,h=!!(l.draggable||e&&typeof l.draggable>"u"),v=!!(l.selectable||r&&typeof l.selectable>"u"),x=!!(l.connectable||n&&typeof l.connectable>"u"),b=!!(l.focusable||o&&typeof l.focusable>"u"),p=t.nodeExtent?Vn(l.positionAbsolute,t.nodeExtent):l.positionAbsolute,S=(p==null?void 0:p.x)??0,$=(p==null?void 0:p.y)??0,m=xu({x:S,y:$,width:l.width??0,height:l.height??0,origin:t.nodeOrigin});return A.jsx(d,{id:l.id,className:l.className,style:l.style,type:f,data:l.data,sourcePosition:l.sourcePosition||V.Bottom,targetPosition:l.targetPosition||V.Top,hidden:l.hidden,xPos:S,yPos:$,xPosOrigin:m.x,yPosOrigin:m.y,selectNodesOnDrag:t.selectNodesOnDrag,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,selected:!!l.selected,isDraggable:h,isSelectable:v,isConnectable:x,isFocusable:b,resizeObserver:u,dragHandle:l.dragHandle,zIndex:((M=l[et])==null?void 0:M.z)??0,isParent:!!((C=l[et])!=null&&C.isParent),noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,initialized:!!l.width&&!!l.height,rfId:t.rfId,disableKeyboardA11y:t.disableKeyboardA11y,ariaLabel:l.ariaLabel},l.id)})})};Qr.displayName="NodeRenderer";var Fu=E.memo(Qr);const Xu=[{level:0,isMaxLevel:!0,edges:[]}];function Yu(t,e,n=!1){let o=-1;const r=t.reduce((i,a)=>{var l,f,d,h;const c=ut(a.zIndex);let u=c?a.zIndex:0;return n&&(u=c?a.zIndex:Math.max(((f=(l=e.get(a.source))==null?void 0:l[et])==null?void 0:f.z)||0,((h=(d=e.get(a.target))==null?void 0:d[et])==null?void 0:h.z)||0)),i[u]?i[u].push(a):i[u]=[a],o=u>o?u:o,i},{}),s=Object.entries(r).map(([i,a])=>{const c=+i;return{edges:a,level:c,isMaxLevel:c===o}});return s.length===0?Xu:s}function ju(t,e,n){const o=q(E.useCallback(r=>t?r.edges.filter(s=>{const i=e.get(s.source),a=e.get(s.target);return(i==null?void 0:i.width)&&(i==null?void 0:i.height)&&(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&gu({sourcePos:i.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:i.width,sourceHeight:i.height,targetWidth:a.width,targetHeight:a.height,width:r.width,height:r.height,transform:r.transform})}):r.edges,[t,e]));return Yu(o,e,n)}const Zu=({color:t="none",strokeWidth:e=1})=>A.jsx("polyline",{stroke:t,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:e,fill:"none",points:"-5,-4 0,0 -5,4"}),Wu=({color:t="none",strokeWidth:e=1})=>A.jsx("polyline",{stroke:t,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:e,fill:t,points:"-5,-4 0,0 -5,4 -5,-4"}),Lo={[Ge.Arrow]:Zu,[Ge.ArrowClosed]:Wu};function Ku(t){const e=nt();return E.useMemo(()=>{var r,s;return Object.prototype.hasOwnProperty.call(Lo,t)?Lo[t]:((s=(r=e.getState()).onError)==null||s.call(r,"009",zt.error009(t)),null)},[t])}const Uu=({id:t,type:e,color:n,width:o=12.5,height:r=12.5,markerUnits:s="strokeWidth",strokeWidth:i,orient:a="auto-start-reverse"})=>{const c=Ku(e);return c?A.jsx("marker",{className:"react-flow__arrowhead",id:t,markerWidth:`${o}`,markerHeight:`${r}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:a,refX:"0",refY:"0",children:A.jsx(c,{color:n,strokeWidth:i})}):null},Gu=({defaultColor:t,rfId:e})=>n=>{const o=[];return n.edges.reduce((r,s)=>([s.markerStart,s.markerEnd].forEach(i=>{if(i&&typeof i=="object"){const a=kn(i,e);o.includes(a)||(r.push({id:a,color:i.color||t,...i}),o.push(a))}}),r),[]).sort((r,s)=>r.id.localeCompare(s.id))},Jr=({defaultColor:t,rfId:e})=>{const n=q(E.useCallback(Gu({defaultColor:t,rfId:e}),[t,e]),(o,r)=>!(o.length!==r.length||o.some((s,i)=>s.id!==r[i].id)));return A.jsx("defs",{children:n.map(o=>A.jsx(Uu,{id:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient},o.id))})};Jr.displayName="MarkerDefinitions";var qu=E.memo(Jr);const Qu=t=>({nodesConnectable:t.nodesConnectable,edgesFocusable:t.edgesFocusable,edgesUpdatable:t.edgesUpdatable,elementsSelectable:t.elementsSelectable,width:t.width,height:t.height,connectionMode:t.connectionMode,nodeInternals:t.nodeInternals,onError:t.onError}),ti=({defaultMarkerColor:t,onlyRenderVisibleElements:e,elevateEdgesOnSelect:n,rfId:o,edgeTypes:r,noPanClassName:s,onEdgeUpdate:i,onEdgeContextMenu:a,onEdgeMouseEnter:c,onEdgeMouseMove:u,onEdgeMouseLeave:l,onEdgeClick:f,edgeUpdaterRadius:d,onEdgeDoubleClick:h,onEdgeUpdateStart:v,onEdgeUpdateEnd:x,children:b})=>{const{edgesFocusable:p,edgesUpdatable:S,elementsSelectable:$,width:m,height:M,connectionMode:C,nodeInternals:P,onError:D}=q(Qu,ot),I=ju(e,P,n);return m?A.jsxs(A.Fragment,{children:[I.map(({level:B,edges:R,isMaxLevel:H})=>A.jsxs("svg",{style:{zIndex:B},width:m,height:M,className:"react-flow__edges react-flow__container",children:[H&&A.jsx(qu,{defaultColor:t,rfId:o}),A.jsx("g",{children:R.map(k=>{const[g,N,w]=To(P.get(k.source)),[y,_,T]=To(P.get(k.target));if(!w||!T)return null;let z=k.type||"default";r[z]||(D==null||D("011",zt.error011(z)),z="default");const L=r[z]||r.default,O=C===Zt.Strict?_.target:(_.target??[]).concat(_.source??[]),Y=ko(N.source,k.sourceHandle),X=ko(O,k.targetHandle),Z=(Y==null?void 0:Y.position)||V.Bottom,W=(X==null?void 0:X.position)||V.Top,K=!!(k.focusable||p&&typeof k.focusable>"u"),U=typeof i<"u"&&(k.updatable||S&&typeof k.updatable>"u");if(!Y||!X)return D==null||D("008",zt.error008(Y,k)),null;const{sourceX:J,sourceY:Q,targetX:lt,targetY:ft}=hu(g,Y,Z,y,X,W);return A.jsx(L,{id:k.id,className:ct([k.className,s]),type:z,data:k.data,selected:!!k.selected,animated:!!k.animated,hidden:!!k.hidden,label:k.label,labelStyle:k.labelStyle,labelShowBg:k.labelShowBg,labelBgStyle:k.labelBgStyle,labelBgPadding:k.labelBgPadding,labelBgBorderRadius:k.labelBgBorderRadius,style:k.style,source:k.source,target:k.target,sourceHandleId:k.sourceHandle,targetHandleId:k.targetHandle,markerEnd:k.markerEnd,markerStart:k.markerStart,sourceX:J,sourceY:Q,targetX:lt,targetY:ft,sourcePosition:Z,targetPosition:W,elementsSelectable:$,onEdgeUpdate:i,onContextMenu:a,onMouseEnter:c,onMouseMove:u,onMouseLeave:l,onClick:f,edgeUpdaterRadius:d,onEdgeDoubleClick:h,onEdgeUpdateStart:v,onEdgeUpdateEnd:x,rfId:o,ariaLabel:k.ariaLabel,isFocusable:K,isUpdatable:U,pathOptions:"pathOptions"in k?k.pathOptions:void 0,interactionWidth:k.interactionWidth},k.id)})})]},B)),b]}):null};ti.displayName="EdgeRenderer";var Ju=E.memo(ti);const tf=t=>`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]})`;function ef({children:t}){const e=q(tf);return A.jsx("div",{className:"react-flow__viewport react-flow__container",style:{transform:e},children:t})}function nf(t){const e=Ur(),n=E.useRef(!1);E.useEffect(()=>{!n.current&&e.viewportInitialized&&t&&(setTimeout(()=>t(e),1),n.current=!0)},[t,e.viewportInitialized])}const of={[V.Left]:V.Right,[V.Right]:V.Left,[V.Top]:V.Bottom,[V.Bottom]:V.Top},ei=({nodeId:t,handleType:e,style:n,type:o=kt.Bezier,CustomComponent:r,connectionStatus:s})=>{var C,P,D;const{fromNode:i,handleId:a,toX:c,toY:u,connectionMode:l}=q(E.useCallback(I=>({fromNode:I.nodeInternals.get(t),handleId:I.connectionHandleId,toX:(I.connectionPosition.x-I.transform[0])/I.transform[2],toY:(I.connectionPosition.y-I.transform[1])/I.transform[2],connectionMode:I.connectionMode}),[t]),ot),f=(C=i==null?void 0:i[et])==null?void 0:C.handleBounds;let d=f==null?void 0:f[e];if(l===Zt.Loose&&(d=d||(f==null?void 0:f[e==="source"?"target":"source"])),!i||!d)return null;const h=a?d.find(I=>I.id===a):d[0],v=h?h.x+h.width/2:(i.width??0)/2,x=h?h.y+h.height/2:i.height??0,b=(((P=i.positionAbsolute)==null?void 0:P.x)??0)+v,p=(((D=i.positionAbsolute)==null?void 0:D.y)??0)+x,S=h==null?void 0:h.position,$=S?of[S]:null;if(!S||!$)return null;if(r)return A.jsx(r,{connectionLineType:o,connectionLineStyle:n,fromNode:i,fromHandle:h,fromX:b,fromY:p,toX:c,toY:u,fromPosition:S,toPosition:$,connectionStatus:s});let m="";const M={sourceX:b,sourceY:p,sourcePosition:S,targetX:c,targetY:u,targetPosition:$};return o===kt.Bezier?[m]=Er(M):o===kt.Step?[m]=$n({...M,borderRadius:0}):o===kt.SmoothStep?[m]=$n(M):o===kt.SimpleBezier?[m]=Sr(M):m=`M${b},${p} ${c},${u}`,A.jsx("path",{d:m,fill:"none",className:"react-flow__connection-path",style:n})};ei.displayName="ConnectionLine";const rf=t=>({nodeId:t.connectionNodeId,handleType:t.connectionHandleType,nodesConnectable:t.nodesConnectable,connectionStatus:t.connectionStatus,width:t.width,height:t.height});function sf({containerStyle:t,style:e,type:n,component:o}){const{nodeId:r,handleType:s,nodesConnectable:i,width:a,height:c,connectionStatus:u}=q(rf,ot);return!(r&&s&&a&&i)?null:A.jsx("svg",{style:t,width:a,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container",children:A.jsx("g",{className:ct(["react-flow__connection",u]),children:A.jsx(ei,{nodeId:r,handleType:s,style:e,type:n,CustomComponent:o,connectionStatus:u})})})}const ni=({nodeTypes:t,edgeTypes:e,onMove:n,onMoveStart:o,onMoveEnd:r,onInit:s,onNodeClick:i,onEdgeClick:a,onNodeDoubleClick:c,onEdgeDoubleClick:u,onNodeMouseEnter:l,onNodeMouseMove:f,onNodeMouseLeave:d,onNodeContextMenu:h,onSelectionContextMenu:v,onSelectionStart:x,onSelectionEnd:b,connectionLineType:p,connectionLineStyle:S,connectionLineComponent:$,connectionLineContainerStyle:m,selectionKeyCode:M,selectionOnDrag:C,selectionMode:P,multiSelectionKeyCode:D,panActivationKeyCode:I,zoomActivationKeyCode:B,deleteKeyCode:R,onlyRenderVisibleElements:H,elementsSelectable:k,selectNodesOnDrag:g,defaultViewport:N,translateExtent:w,minZoom:y,maxZoom:_,preventScrolling:T,defaultMarkerColor:z,zoomOnScroll:L,zoomOnPinch:O,panOnScroll:Y,panOnScrollSpeed:X,panOnScrollMode:Z,zoomOnDoubleClick:W,panOnDrag:K,onPaneClick:U,onPaneMouseEnter:J,onPaneMouseMove:Q,onPaneMouseLeave:lt,onPaneScroll:ft,onPaneContextMenu:mt,onEdgeUpdate:tt,onEdgeContextMenu:G,onEdgeMouseEnter:rt,onEdgeMouseMove:F,onEdgeMouseLeave:Et,edgeUpdaterRadius:Dt,onEdgeUpdateStart:ue,onEdgeUpdateEnd:fe,noDragClassName:Wt,noWheelClassName:Rt,noPanClassName:Nt,elevateEdgesOnSelect:Kt,disableKeyboardA11y:Mt,nodeOrigin:It,nodeExtent:de,rfId:Ut})=>(nf(s),A.jsx(Bu,{onPaneClick:U,onPaneMouseEnter:J,onPaneMouseMove:Q,onPaneMouseLeave:lt,onPaneContextMenu:mt,onPaneScroll:ft,deleteKeyCode:R,selectionKeyCode:M,selectionOnDrag:C,selectionMode:P,onSelectionStart:x,onSelectionEnd:b,multiSelectionKeyCode:D,panActivationKeyCode:I,zoomActivationKeyCode:B,elementsSelectable:k,onMove:n,onMoveStart:o,onMoveEnd:r,zoomOnScroll:L,zoomOnPinch:O,zoomOnDoubleClick:W,panOnScroll:Y,panOnScrollSpeed:X,panOnScrollMode:Z,panOnDrag:K,defaultViewport:N,translateExtent:w,minZoom:y,maxZoom:_,onSelectionContextMenu:v,preventScrolling:T,noDragClassName:Wt,noWheelClassName:Rt,noPanClassName:Nt,disableKeyboardA11y:Mt,children:A.jsxs(ef,{children:[A.jsx(Ju,{edgeTypes:e,onEdgeClick:a,onEdgeDoubleClick:u,onEdgeUpdate:tt,onlyRenderVisibleElements:H,onEdgeContextMenu:G,onEdgeMouseEnter:rt,onEdgeMouseMove:F,onEdgeMouseLeave:Et,onEdgeUpdateStart:ue,onEdgeUpdateEnd:fe,edgeUpdaterRadius:Dt,defaultMarkerColor:z,noPanClassName:Nt,elevateEdgesOnSelect:!!Kt,disableKeyboardA11y:Mt,rfId:Ut,children:A.jsx(sf,{style:S,type:p,component:$,containerStyle:m})}),A.jsx("div",{className:"react-flow__edgelabel-renderer"}),A.jsx(Fu,{nodeTypes:t,onNodeClick:i,onNodeDoubleClick:c,onNodeMouseEnter:l,onNodeMouseMove:f,onNodeMouseLeave:d,onNodeContextMenu:h,selectNodesOnDrag:g,onlyRenderVisibleElements:H,noPanClassName:Nt,noDragClassName:Wt,disableKeyboardA11y:Mt,nodeOrigin:It,nodeExtent:de,rfId:Ut})]})}));ni.displayName="GraphView";var af=E.memo(ni);const zn=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Ct={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:zn,nodeExtent:zn,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Zt.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:zl,isValidConnection:void 0},cf=()=>Xi((t,e)=>({...Ct,setNodes:n=>{const{nodeInternals:o,nodeOrigin:r,elevateNodesOnSelect:s}=e();t({nodeInternals:yn(n,o,r,s)})},getNodes:()=>Array.from(e().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:o={}}=e();t({edges:n.map(r=>({...o,...r}))})},setDefaultNodesAndEdges:(n,o)=>{const r=typeof n<"u",s=typeof o<"u",i=r?yn(n,new Map,e().nodeOrigin,e().elevateNodesOnSelect):new Map;t({nodeInternals:i,edges:s?o:[],hasDefaultNodes:r,hasDefaultEdges:s})},updateNodeDimensions:n=>{const{onNodesChange:o,nodeInternals:r,fitViewOnInit:s,fitViewOnInitDone:i,fitViewOnInitOptions:a,domNode:c,nodeOrigin:u}=e(),l=c==null?void 0:c.querySelector(".react-flow__viewport");if(!l)return;const f=window.getComputedStyle(l),{m22:d}=new window.DOMMatrixReadOnly(f.transform),h=n.reduce((x,b)=>{const p=r.get(b.id);if(p){const S=On(b.nodeElement);!!(S.width&&S.height&&(p.width!==S.width||p.height!==S.height||b.forceUpdate))&&(r.set(p.id,{...p,[et]:{...p[et],handleBounds:{source:zo(".source",b.nodeElement,d,u),target:zo(".target",b.nodeElement,d,u)}},...S}),x.push({id:p.id,type:"dimensions",dimensions:S}))}return x},[]);Wr(r,u);const v=i||s&&!i&&Kr(e,{initial:!0,...a});t({nodeInternals:new Map(r),fitViewOnInitDone:v}),(h==null?void 0:h.length)>0&&(o==null||o(h))},updateNodePositions:(n,o=!0,r=!1)=>{const{triggerNodeChanges:s}=e(),i=n.map(a=>{const c={id:a.id,type:"position",dragging:r};return o&&(c.positionAbsolute=a.positionAbsolute,c.position=a.position),c});s(i)},triggerNodeChanges:n=>{const{onNodesChange:o,nodeInternals:r,hasDefaultNodes:s,nodeOrigin:i,getNodes:a,elevateNodesOnSelect:c}=e();if(n!=null&&n.length){if(s){const u=zu(n,a()),l=yn(u,r,i,c);t({nodeInternals:l})}o==null||o(n)}},addSelectedNodes:n=>{const{multiSelectionActive:o,edges:r,getNodes:s}=e();let i,a=null;o?i=n.map(c=>$t(c,!0)):(i=te(s(),n),a=te(r,[])),Be({changedNodes:i,changedEdges:a,get:e,set:t})},addSelectedEdges:n=>{const{multiSelectionActive:o,edges:r,getNodes:s}=e();let i,a=null;o?i=n.map(c=>$t(c,!0)):(i=te(r,n),a=te(s(),[])),Be({changedNodes:a,changedEdges:i,get:e,set:t})},unselectNodesAndEdges:({nodes:n,edges:o}={})=>{const{edges:r,getNodes:s}=e(),i=n||s(),a=o||r,c=i.map(l=>(l.selected=!1,$t(l.id,!1))),u=a.map(l=>$t(l.id,!1));Be({changedNodes:c,changedEdges:u,get:e,set:t})},setMinZoom:n=>{const{d3Zoom:o,maxZoom:r}=e();o==null||o.scaleExtent([n,r]),t({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:o,minZoom:r}=e();o==null||o.scaleExtent([r,n]),t({maxZoom:n})},setTranslateExtent:n=>{var o;(o=e().d3Zoom)==null||o.translateExtent(n),t({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:o}=e(),s=o().filter(a=>a.selected).map(a=>$t(a.id,!1)),i=n.filter(a=>a.selected).map(a=>$t(a.id,!1));Be({changedNodes:s,changedEdges:i,get:e,set:t})},setNodeExtent:n=>{const{nodeInternals:o}=e();o.forEach(r=>{r.positionAbsolute=Vn(r.position,n)}),t({nodeExtent:n,nodeInternals:new Map(o)})},panBy:n=>{const{transform:o,width:r,height:s,d3Zoom:i,d3Selection:a,translateExtent:c}=e();if(!i||!a||!n.x&&!n.y)return!1;const u=Tt.translate(o[0]+n.x,o[1]+n.y).scale(o[2]),l=[[0,0],[r,s]],f=i==null?void 0:i.constrain()(u,l,c);return i.transform(a,f),o[0]!==f.x||o[1]!==f.y||o[2]!==f.k},cancelConnection:()=>t({connectionNodeId:Ct.connectionNodeId,connectionHandleId:Ct.connectionHandleId,connectionHandleType:Ct.connectionHandleType,connectionStatus:Ct.connectionStatus,connectionStartHandle:Ct.connectionStartHandle,connectionEndHandle:Ct.connectionEndHandle}),reset:()=>t({...Ct})})),oi=({children:t})=>{const e=E.useRef(null);return e.current||(e.current=cf()),A.jsx(El,{value:e.current,children:t})};oi.displayName="ReactFlowProvider";const ri=({children:t})=>E.useContext(nn)?A.jsx(A.Fragment,{children:t}):A.jsx(oi,{children:t});ri.displayName="ReactFlowWrapper";function Bo(t,e){return E.useRef(null),E.useMemo(()=>e(t),[t])}const lf={input:Ir,default:Tn,output:Lr,group:Zn},uf={default:qe,straight:Yn,step:Xn,smoothstep:on,simplebezier:Fn},ff=[0,0],df=[15,15],hf={x:0,y:0,zoom:1},gf={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},ii=E.forwardRef(({nodes:t,edges:e,defaultNodes:n,defaultEdges:o,className:r,nodeTypes:s=lf,edgeTypes:i=uf,onNodeClick:a,onEdgeClick:c,onInit:u,onMove:l,onMoveStart:f,onMoveEnd:d,onConnect:h,onConnectStart:v,onConnectEnd:x,onClickConnectStart:b,onClickConnectEnd:p,onNodeMouseEnter:S,onNodeMouseMove:$,onNodeMouseLeave:m,onNodeContextMenu:M,onNodeDoubleClick:C,onNodeDragStart:P,onNodeDrag:D,onNodeDragStop:I,onNodesDelete:B,onEdgesDelete:R,onSelectionChange:H,onSelectionDragStart:k,onSelectionDrag:g,onSelectionDragStop:N,onSelectionContextMenu:w,onSelectionStart:y,onSelectionEnd:_,connectionMode:T=Zt.Strict,connectionLineType:z=kt.Bezier,connectionLineStyle:L,connectionLineComponent:O,connectionLineContainerStyle:Y,deleteKeyCode:X="Backspace",selectionKeyCode:Z="Shift",selectionOnDrag:W=!1,selectionMode:K=Me.Full,panActivationKeyCode:U="Space",multiSelectionKeyCode:J="Meta",zoomActivationKeyCode:Q="Meta",snapToGrid:lt=!1,snapGrid:ft=df,onlyRenderVisibleElements:mt=!1,selectNodesOnDrag:tt=!0,nodesDraggable:G,nodesConnectable:rt,nodesFocusable:F,nodeOrigin:Et=ff,edgesFocusable:Dt,edgesUpdatable:ue,elementsSelectable:fe,defaultViewport:Wt=hf,minZoom:Rt=.5,maxZoom:Nt=2,translateExtent:Kt=zn,preventScrolling:Mt=!0,nodeExtent:It,defaultMarkerColor:de="#b1b1b7",zoomOnScroll:Ut=!0,zoomOnPinch:it=!0,panOnScroll:dt=!1,panOnScrollSpeed:Ht=.5,panOnScrollMode:Lt=oe.Free,zoomOnDoubleClick:Bt=!0,panOnDrag:Te=!0,onPaneClick:Ot,onPaneMouseEnter:rn,onPaneMouseMove:sn,onPaneMouseLeave:he,onPaneScroll:an,onPaneContextMenu:Kn,children:Vt,onEdgeUpdate:ai,onEdgeContextMenu:ci,onEdgeDoubleClick:li,onEdgeMouseEnter:ui,onEdgeMouseMove:fi,onEdgeMouseLeave:di,onEdgeUpdateStart:hi,onEdgeUpdateEnd:gi,edgeUpdaterRadius:pi=10,onNodesChange:yi,onEdgesChange:mi,noDragClassName:xi="nodrag",noWheelClassName:wi="nowheel",noPanClassName:Un="nopan",fitView:bi=!1,fitViewOptions:vi,connectOnClick:_i=!0,attributionPosition:Si,proOptions:Ei,defaultEdgeOptions:Ni,elevateNodesOnSelect:Mi=!0,elevateEdgesOnSelect:Ci=!1,disableKeyboardA11y:Gn=!1,autoPanOnConnect:Ai=!0,autoPanOnNodeDrag:$i=!0,connectionRadius:ki=20,isValidConnection:Ti,onError:Pi,style:zi,id:qn,...Di},Ri)=>{const Ii=Bo(s,mu),Hi=Bo(i,du),cn=qn||"1";return A.jsx("div",{...Di,style:{...zi,...gf},ref:Ri,className:ct(["react-flow",r]),"data-testid":"rf__wrapper",id:qn,children:A.jsxs(ri,{children:[A.jsx(af,{onInit:u,onMove:l,onMoveStart:f,onMoveEnd:d,onNodeClick:a,onEdgeClick:c,onNodeMouseEnter:S,onNodeMouseMove:$,onNodeMouseLeave:m,onNodeContextMenu:M,onNodeDoubleClick:C,nodeTypes:Ii,edgeTypes:Hi,connectionLineType:z,connectionLineStyle:L,connectionLineComponent:O,connectionLineContainerStyle:Y,selectionKeyCode:Z,selectionOnDrag:W,selectionMode:K,deleteKeyCode:X,multiSelectionKeyCode:J,panActivationKeyCode:U,zoomActivationKeyCode:Q,onlyRenderVisibleElements:mt,selectNodesOnDrag:tt,defaultViewport:Wt,translateExtent:Kt,minZoom:Rt,maxZoom:Nt,preventScrolling:Mt,zoomOnScroll:Ut,zoomOnPinch:it,zoomOnDoubleClick:Bt,panOnScroll:dt,panOnScrollSpeed:Ht,panOnScrollMode:Lt,panOnDrag:Te,onPaneClick:Ot,onPaneMouseEnter:rn,onPaneMouseMove:sn,onPaneMouseLeave:he,onPaneScroll:an,onPaneContextMenu:Kn,onSelectionContextMenu:w,onSelectionStart:y,onSelectionEnd:_,onEdgeUpdate:ai,onEdgeContextMenu:ci,onEdgeDoubleClick:li,onEdgeMouseEnter:ui,onEdgeMouseMove:fi,onEdgeMouseLeave:di,onEdgeUpdateStart:hi,onEdgeUpdateEnd:gi,edgeUpdaterRadius:pi,defaultMarkerColor:de,noDragClassName:xi,noWheelClassName:wi,noPanClassName:Un,elevateEdgesOnSelect:Ci,rfId:cn,disableKeyboardA11y:Gn,nodeOrigin:Et,nodeExtent:It}),A.jsx(ou,{nodes:t,edges:e,defaultNodes:n,defaultEdges:o,onConnect:h,onConnectStart:v,onConnectEnd:x,onClickConnectStart:b,onClickConnectEnd:p,nodesDraggable:G,nodesConnectable:rt,nodesFocusable:F,edgesFocusable:Dt,edgesUpdatable:ue,elementsSelectable:fe,elevateNodesOnSelect:Mi,minZoom:Rt,maxZoom:Nt,nodeExtent:It,onNodesChange:yi,onEdgesChange:mi,snapToGrid:lt,snapGrid:ft,connectionMode:T,translateExtent:Kt,connectOnClick:_i,defaultEdgeOptions:Ni,fitView:bi,fitViewOptions:vi,onNodesDelete:B,onEdgesDelete:R,onNodeDragStart:P,onNodeDrag:D,onNodeDragStop:I,onSelectionDrag:g,onSelectionDragStart:k,onSelectionDragStop:N,noPanClassName:Un,nodeOrigin:Et,rfId:cn,autoPanOnConnect:Ai,autoPanOnNodeDrag:$i,onError:Pi,connectionRadius:ki,isValidConnection:Ti}),A.jsx(eu,{onSelectionChange:H}),Vt,A.jsx(Cl,{proOptions:Ei,position:Si}),A.jsx(cu,{rfId:cn,disableKeyboardA11y:Gn})]})})});ii.displayName="ReactFlow";var pt;(function(t){t.Lines="lines",t.Dots="dots",t.Cross="cross"})(pt||(pt={}));function pf({color:t,dimensions:e,lineWidth:n}){return A.jsx("path",{stroke:t,strokeWidth:n,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`})}function yf({color:t,radius:e}){return A.jsx("circle",{cx:e,cy:e,r:e,fill:t})}const mf={[pt.Dots]:"#91919a",[pt.Lines]:"#eee",[pt.Cross]:"#e2e2e2"},xf={[pt.Dots]:1,[pt.Lines]:1,[pt.Cross]:6},wf=t=>({transform:t.transform,patternId:`pattern-${t.rfId}`});function si({id:t,variant:e=pt.Dots,gap:n=20,size:o,lineWidth:r=1,offset:s=2,color:i,style:a,className:c}){const u=E.useRef(null),{transform:l,patternId:f}=q(wf,ot),d=i||mf[e],h=o||xf[e],v=e===pt.Dots,x=e===pt.Cross,b=Array.isArray(n)?n:[n,n],p=[b[0]*l[2]||1,b[1]*l[2]||1],S=h*l[2],$=x?[S,S]:p,m=v?[S/s,S/s]:[$[0]/s,$[1]/s];return A.jsxs("svg",{className:ct(["react-flow__background",c]),style:{...a,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:u,"data-testid":"rf__background",children:[A.jsx("pattern",{id:f+t,x:l[0]%p[0],y:l[1]%p[1],width:p[0],height:p[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${m[0]},-${m[1]})`,children:v?A.jsx(yf,{color:d,radius:S/s}):A.jsx(pf,{dimensions:$,color:d,lineWidth:r})}),A.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${f+t})`})]})}si.displayName="Background";var bf=E.memo(si),vf=Fi({d:"M23.555,8.729a1.505,1.505,0,0,0-1.406-.98H16.062a.5.5,0,0,1-.472-.334L13.405,1.222a1.5,1.5,0,0,0-2.81,0l-.005.016L8.41,7.415a.5.5,0,0,1-.471.334H1.85A1.5,1.5,0,0,0,.887,10.4l5.184,4.3a.5.5,0,0,1,.155.543L4.048,21.774a1.5,1.5,0,0,0,2.31,1.684l5.346-3.92a.5.5,0,0,1,.591,0l5.344,3.919a1.5,1.5,0,0,0,2.312-1.683l-2.178-6.535a.5.5,0,0,1,.155-.543l5.194-4.306A1.5,1.5,0,0,0,23.555,8.729Z",displayName:"StarIcon"});const _f=({data:t})=>{var o;const{language:e}=Oi(),n=(o=t==null?void 0:t.names)==null?void 0:o.map(r=>{var s,i,a,c;return A.jsxs(A.Fragment,{children:[A.jsx(le,{type:"target",position:V.Top,style:{background:"#555"}}),A.jsxs("p",{style:{color:r!=null&&r.isMale?"red":"green"},children:[(r==null?void 0:r.isWang)&&A.jsx(vf,{}),r!=null&&r.hasBio?A.jsx(Bi,{to:`/${r==null?void 0:r.id}`,className:"underline hover:no-underline",children:e==="English"?(s=r==null?void 0:r.name)==null?void 0:s.english:(i=r==null?void 0:r.name)==null?void 0:i.chinese}):e==="English"?(a=r==null?void 0:r.name)==null?void 0:a.english:(c=r==null?void 0:r.name)==null?void 0:c.chinese]}),A.jsx(le,{type:"source",position:V.Bottom,style:{background:"#555"}})]})});return A.jsx("div",{style:{textAlign:"center"},children:n})},Sf=E.memo(_f);const Ef="_legend_ossud_1",Nf="_flowGraph_ossud_7",Oo={legend:Ef,flowGraph:Nf},Mf=E.lazy(()=>Vo(()=>import("./index-1b5a18e4.js"),["assets/index-1b5a18e4.js","assets/index-5d09a97b.js","assets/index-7c6a42e3.css","assets/chunk-QODHG6BI-5c01519f.js","assets/chunk-B2MGPQRJ-72dc18a0.js","assets/chunk-NAA7TEES-10ab53b1.js"])),Cf=E.lazy(()=>Vo(()=>import("./index-ad47bb23.js"),["assets/index-ad47bb23.js","assets/index-5d09a97b.js","assets/index-7c6a42e3.css","assets/chunk-QODHG6BI-5c01519f.js","assets/useLanguageSelector-34e5d545.js","assets/chunk-NAA7TEES-10ab53b1.js","assets/index-89c7eadc.css"])),Af=()=>{var o;const[t,e]=E.useState(void 0),n=E.useMemo(()=>({wangNode:Sf}),[]);return E.useEffect(()=>{Vi.getTree().then(({data:r})=>{e(r)})},[]),A.jsxs(E.Suspense,{fallback:"Loading...",children:[A.jsx(Cf,{}),A.jsxs("div",{className:Oo.flowGraph,children:[A.jsx(ii,{nodes:(o=t==null?void 0:t.nodes)==null?void 0:o.map(r=>({...r,style:{border:"1px solid #777",padding:10,borderRadius:"5px",width:"150px"}})),edges:t==null?void 0:t.edges,nodeTypes:n,fitView:!0,children:A.jsx(bf,{color:"#aaa",gap:16})}),A.jsx("div",{className:Oo.legend,children:A.jsx(Mf,{})})]})]})},Pf=E.memo(Af);export{Pf as default};
